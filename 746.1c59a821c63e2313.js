"use strict";(self.webpackChunkpages=self.webpackChunkpages||[]).push([[746],{180:(xt,W,c)=>{c.d(W,{P:()=>Ct});var B=c(467),N=c(2998),t=c(1148),h=c(4819),l=c(3664),tt=c(5652),H=c(4310),et=c(4033),K=c(9986),F=c(4330),Q=c(2200),Y=c(9944),U=c(45);const ot=d=>({"touch-device":d}),S=d=>({height:d}),x=(d,v)=>({$implicit:d,type:"forum",deleted:v}),L=(d,v,f)=>({$implicit:d,sub:v,link:f}),k=d=>({"mt-3":d}),j=(d,v,f)=>({$implicit:d,type:v,deleted:f});function $(d,v){1&d&&l.eu8(0)}function G(d,v){1&d&&l.eu8(0)}function Ot(d,v){if(1&d&&(l.j41(0,"li",9),l.DNE(1,G,1,0,"ng-container",5),l.k0s()),2&d){const f=v.$implicit;l.XpG(3);const C=l.sdS(6);l.R7$(),l.Y8G("ngTemplateOutlet",C)("ngTemplateOutletContext",l.sMw(2,L,f.name,f.domain,f.link))}}function rt(d,v){if(1&d&&(l.qex(0),l.Z7z(1,Ot,2,6,"li",9,l.fX1),l.bVm()),2&d){const f=v.$implicit;l.R7$(),l.Dyx(f)}}function mt(d,v){if(1&d&&(l.j41(0,"fieldset",3),l.DNE(1,$,1,0,"ng-container",5),l.j41(2,"cdk-virtual-scroll-viewport",6)(3,"ul",7),l.DNE(4,rt,3,0,"ng-container",8),l.nI1(5,"arrayChunk"),l.k0s()()()),2&d){const f=l.XpG(),C=l.sdS(4);l.R7$(),l.Y8G("ngTemplateOutlet",C)("ngTemplateOutletContext",l.l_i(7,x,f.forums.length,f.forumsWithDeletedCount-f.forums.length)),l.R7$(),l.Y8G("itemSize",78),l.R7$(2),l.Y8G("cdkVirtualForOf",l.i5U(5,4,f.forums,f.itemsPerRow))}}function Dt(d,v){1&d&&l.eu8(0)}function ft(d,v){1&d&&l.eu8(0)}function vt(d,v){if(1&d&&(l.j41(0,"li",9),l.DNE(1,ft,1,0,"ng-container",5),l.nI1(2,"titlecase"),l.k0s()),2&d){const f=v.$implicit;l.XpG(3);const C=l.sdS(6);l.R7$(),l.Y8G("ngTemplateOutlet",C)("ngTemplateOutletContext",l.sMw(4,L,f.name,l.bMT(2,2,f.site)+" id: "+f.id,f.link))}}function Mt(d,v){if(1&d&&(l.qex(0),l.Z7z(1,vt,3,8,"li",9,l.fX1),l.bVm()),2&d){const f=v.$implicit;l.R7$(),l.Dyx(f)}}function Tt(d,v){if(1&d&&(l.j41(0,"fieldset",4),l.DNE(1,Dt,1,0,"ng-container",5),l.j41(2,"cdk-virtual-scroll-viewport",6)(3,"ul",7),l.DNE(4,Mt,3,0,"ng-container",8),l.nI1(5,"arrayChunk"),l.k0s()()()),2&d){const f=l.XpG(),C=l.sdS(4);l.Y8G("ngClass",l.eq3(8,k,f.forums.length>0)),l.R7$(),l.Y8G("ngTemplateOutlet",C)("ngTemplateOutletContext",l.sMw(10,j,f.users.length,"utent"+(1===f.users.length?"e":"i"),f.usersWithDeletedCount-f.users.length)),l.R7$(),l.Y8G("itemSize",78),l.R7$(2),l.Y8G("cdkVirtualForOf",l.i5U(5,5,f.users,f.itemsPerRow))}}function Pt(d,v){if(1&d&&(l.j41(0,"legend",10)(1,"div",11),l.nrm(2,"div",12)(3,"div",13),l.k0s()()),2&d){const f=v.$implicit,C=v.type,y=v.deleted;l.R7$(2),l.Y8G("innerText",f+" "+C),l.R7$(),l.Y8G("innerText","("+y+" cancellat"+(1===y?"o":"i")+")")}}function Lt(d,v){if(1&d&&(l.j41(0,"a",14),l.nrm(1,"div",15)(2,"div",16),l.k0s()),2&d){const f=v.$implicit,C=v.sub;l.Y8G("href",v.link,l.B4B),l.R7$(),l.Y8G("innerHTML",f,l.npT),l.R7$(),l.Y8G("innerHTML",C,l.npT)}}let Ft=(()=>{var d;class v{constructor(C){this.breakpointObserver=C,this.forums=[],this.users=[],this.forumsWithDeletedCount=0,this.usersWithDeletedCount=0,this.touchDevice=K.CN,this.itemsPerRow=1,this.wrapperStyleHeight="",this.breakpoints={W_992_I_1:"(max-width: 991.98px)",W_1200_I_2:"(min-width: 992px) and (max-width: 1199.98px)",W_MAX_I_4:"(min-width:1200px)"},this.itemsPerRowMap=new Map([[this.breakpoints.W_992_I_1,1],[this.breakpoints.W_1200_I_2,2],[this.breakpoints.W_MAX_I_4,4]])}ngOnInit(){this.breakpointObserverSubscription=this.breakpointObserver.observe(Object.values(this.breakpoints)).subscribe(C=>{for(const y of Object.keys(C.breakpoints))if(C.breakpoints[y]){this.itemsPerRow=this.itemsPerRowMap.get(y)??1;const O=Math.ceil(this.forums.length/this.itemsPerRow),w=Math.ceil(this.users.length/this.itemsPerRow),it=O>0&&w>0,Rt=Math.max(0,78*O-16)+Math.max(0,78*w-16)+35*(it?2:1);this.wrapperStyleHeight=`calc(${Rt}px + ${2+(it?4:1.5)}rem)`}})}ngOnDestroy(){this.breakpointObserverSubscription?.unsubscribe()}static#t=d=()=>(this.\u0275fac=function(y){return new(y||v)(l.rXU(F.Q))},this.\u0275cmp=l.VBU({type:v,selectors:[["app-details-list"]],inputs:{forums:"forums",users:"users",forumsWithDeletedCount:"forumsWithDeletedCount",usersWithDeletedCount:"usersWithDeletedCount"},standalone:!1,decls:7,vars:8,consts:[["legend",""],["listItem",""],["cdkVirtualScrollingElement","",1,"wrapper","overflow-auto","mh-100","p-3","w-100",3,"ngClass","ngStyle"],[1,"border","rounded","p-3","pt-2"],[1,"border","rounded","p-3","pt-2",3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"v-scroll",3,"itemSize"],[1,"list-unstyled","mb-0"],[4,"cdkVirtualFor","cdkVirtualForOf"],[1,"min-w-0","list-item","rounded"],[1,"legend-reset","pb-1","px-2","mb-0","mx-auto"],[1,"d-flex","flex-row","flex-wrap","align-items-center","justify-content-center"],[1,"mx-1","fs-xl",3,"innerText"],[1,"mx-1","fs-reset","lh-1","fst-italic","deleted-items",3,"innerText"],["target","_blank",1,"text-center","d-block","bg-light","border","px-3","py-2","rounded","mw-100",3,"href"],[1,"text-uppercase","text-primary","text-truncate",3,"innerHTML"],[1,"text-muted","fs-xs","text-truncate",3,"innerHTML"]],template:function(y,O){1&y&&(l.j41(0,"div",2),l.nVh(1,mt,6,10,"fieldset",3),l.nVh(2,Tt,6,14,"fieldset",4),l.k0s(),l.DNE(3,Pt,4,2,"ng-template",null,0,l.C5r)(5,Lt,3,3,"ng-template",null,1,l.C5r)),2&y&&(l.Y8G("ngClass",l.eq3(4,ot,O.touchDevice))("ngStyle",l.eq3(6,S,O.wrapperStyleHeight)),l.R7$(),l.vxM(O.forums.length>0?1:-1),l.R7$(),l.vxM(O.users.length>0?2:-1))},dependencies:[Q.YU,Q.T3,Q.B3,Y.yg,Y.E$,Y.d6,Y.fZ,U.X,Q.PV],styles:["fieldset[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:grid;row-gap:16px}.v-scroll[_ngcontent-%COMP%]{margin-bottom:-16px!important}.v-scroll[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-bottom:16px!important}.wrapper[_ngcontent-%COMP%]:not(.touch-device)   .list-item[_ngcontent-%COMP%]{transition:box-shadow .2s;box-shadow:none}.wrapper[_ngcontent-%COMP%]:not(.touch-device)   .list-item[_ngcontent-%COMP%]:hover{box-shadow:0 .5rem 1rem #00000026}.wrapper[_ngcontent-%COMP%]:not(.touch-device)   .v-scroll[_ngcontent-%COMP%]{margin-left:-1rem!important;margin-right:-1rem!important}.wrapper[_ngcontent-%COMP%]:not(.touch-device)   .v-scroll[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:1rem!important;padding-right:1rem!important}legend[_ngcontent-%COMP%]{height:33px}legend[_ngcontent-%COMP%]   .deleted-items[_ngcontent-%COMP%]{padding-top:.175rem}.list-item[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:62px}@media (min-width: 576px){fieldset[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(250px,1fr));column-gap:16px}}"]}))}return d(),v})();const It=["modal"],X=()=>["d-flex","p-0"];function Z(d,v){1&d&&l.nrm(0,"app-loader",4)}function kt(d,v){if(1&d&&l.nrm(0,"app-details-list",5),2&d){const f=l.XpG(3);l.Y8G("forums",f.forums)("users",f.users)("forumsWithDeletedCount",f.scriptWithStats.stats.forums.length)("usersWithDeletedCount",f.scriptWithStats.stats.users.length)}}function _t(d,v){if(1&d&&l.nVh(0,kt,1,4,"app-details-list",5),2&d){const f=l.XpG(2);l.vxM(f.scriptWithStats?0:-1)}}function gt(d,v){if(1&d&&l.nVh(0,Z,1,0,"app-loader",4)(1,_t,1,1),2&d){const f=l.XpG();l.vxM(f.loading?0:1)}}function pt(d,v){if(1&d&&l.nrm(0,"div",6),2&d){const f=l.XpG();l.Y8G("innerHTML",f.forumsAndUsersCount+" "+(1===f.forumsAndUsersCount?"installazione totale":"installazioni totali"),l.npT)}}let Ct=(()=>{var d;class v{constructor(C){this.scriptDevService=C,this.modalTitle="",this.loading=!0,this.users=[],this.forums=[],this.forumsAndUsersCount=0}ngOnChanges(C){var y=this;return(0,B.A)(function*(){C.scriptWithStats&&y.scriptWithStats&&(y.loading=!0,y.forums=[],y.users=[],y.forumsAndUsersCount=0,y.modalTitle=`Dettagli dello script <em>${y.scriptWithStats?.script.name||""}</em>`,yield y.setData(),y.loading=!1)})()}open(){this.modalComponentRef.open()}setData(){var C=this;return(0,B.A)(function*(){if(!C.scriptWithStats)return;C.forumsAndUsersCount=C.scriptWithStats.stats.forums.length+C.scriptWithStats.stats.users.length;const y=yield C.scriptDevService.getScriptStatsDetails(C.scriptWithStats);C.forums=y.forums.sort((O,w)=>O.domain.localeCompare(w.domain)).map(O=>({domain:O.domain,link:`https://${O.domain}`,name:O.domain.split(".")[0]})),C.users=y.users.sort((O,w)=>O.nickname.localeCompare(w.nickname)).map(O=>{const w=O.uid.substring(0,2),it=O.uid.substring(2);return{name:O.nickname,id:it,site:((0,N.bl)(w)?.split(".")||["forumfree"])[0],link:((0,N.nv)(w)||"")+`/?act=Profile&MID=${it}`}})})()}static#t=d=()=>(this.\u0275fac=function(y){return new(y||v)(l.rXU(h.u))},this.\u0275cmp=l.VBU({type:v,selectors:[["app-script-dev-stats-details"]],viewQuery:function(y,O){if(1&y&&l.GBs(It,5),2&y){let w;l.mGM(w=l.lsd())&&(O.modalComponentRef=w.first)}},inputs:{scriptWithStats:"scriptWithStats"},standalone:!1,features:[l.OA$],decls:4,vars:3,consts:[["modal",""],["size","xl",3,"title","bodyClass"],["appModalBody",""],["appModalFooter",""],["message","Recupero dei dettagli",1,"d-flex","align-items-center","justify-content-center","w-100","p-3"],[1,"d-block","w-100",3,"forums","users","forumsWithDeletedCount","usersWithDeletedCount"],[1,"me-auto",3,"innerHTML"]],template:function(y,O){1&y&&(l.j41(0,"app-modal",1,0),l.DNE(2,gt,2,1,"ng-template",2)(3,pt,1,1,"ng-template",3),l.k0s()),2&y&&l.Y8G("title",O.modalTitle)("bodyClass",l.lJ4(2,X))},dependencies:[tt.V,t.z,H.d,et.I,Ft],encapsulation:2}))}return d(),v})()},3746:(xt,W,c)=>{c.r(W),c.d(W,{ScriptDevModule:()=>ii});var B=c(1625),N=c(2200),t=c(3664),h=c(2615),l=function(){return l=Object.assign||function(r){for(var s,o=1,e=arguments.length;o<e;o++)for(var i in s=arguments[o])Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i]);return r},l.apply(this,arguments)},tt=function(){function r(s,o,e){var i=this;this.endVal=o,this.options=e,this.version="2.9.0",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(n){i.startTime||(i.startTime=n);var a=n-i.startTime;i.remaining=i.duration-a,i.frameVal=i.useEasing?i.countDown?i.startVal-i.easingFn(a,0,i.startVal-i.endVal,i.duration):i.easingFn(a,i.startVal,i.endVal-i.startVal,i.duration):i.startVal+a/i.duration*(i.endVal-i.startVal),i.frameVal=(i.countDown?i.frameVal<i.endVal:i.frameVal>i.endVal)?i.endVal:i.frameVal,i.frameVal=Number(i.frameVal.toFixed(i.options.decimalPlaces)),i.printValue(i.frameVal),a<i.duration?i.rAF=requestAnimationFrame(i.count):null!==i.finalEndVal?i.update(i.finalEndVal):i.options.onCompleteCallback&&i.options.onCompleteCallback()},this.formatNumber=function(n){var a,p,m,_,g=n<0?"-":"";a=Math.abs(n).toFixed(i.options.decimalPlaces);var u=(a+="").split(".");if(p=u[0],m=u.length>1?i.options.decimal+u[1]:"",i.options.useGrouping){_="";for(var b=3,M=0,I=0,T=p.length;I<T;++I)i.options.useIndianSeparators&&4===I&&(b=2,M=1),0!==I&&M%b==0&&(_=i.options.separator+_),M++,_=p[T-I-1]+_;p=_}return i.options.numerals&&i.options.numerals.length&&(p=p.replace(/[0-9]/g,function(E){return i.options.numerals[+E]}),m=m.replace(/[0-9]/g,function(E){return i.options.numerals[+E]})),g+i.options.prefix+p+m+i.options.suffix},this.easeOutExpo=function(n,a,p,m){return p*(1-Math.pow(2,-10*n/m))*1024/1023+a},this.options=l(l({},this.defaults),e),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.el="string"==typeof s?document.getElementById(s):s,o=o??this.parse(this.el.innerHTML),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(o),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,""===this.options.separator&&(this.options.useGrouping=!1),this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,s):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push(function(){return i.handleScroll(i)}),window.onscroll=function(){window.onScrollFns.forEach(function(n){return n()})},this.handleScroll(this)))}return r.prototype.handleScroll=function(s){if(s&&window&&!s.once){var o=window.innerHeight+window.scrollY,e=s.el.getBoundingClientRect(),i=e.top+window.pageYOffset,n=e.top+e.height+window.pageYOffset;n<o&&n>window.scrollY&&s.paused?(s.paused=!1,setTimeout(function(){return s.start()},s.options.scrollSpyDelay),s.options.scrollSpyOnce&&(s.once=!0)):(window.scrollY>n||i>o)&&!s.paused&&s.reset()}},r.prototype.determineDirectionAndSmartEasing=function(){var s=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>s,Math.abs(s-this.startVal)>this.options.smartEasingThreshold&&this.options.useEasing?(this.finalEndVal=s,this.endVal=s+(this.countDown?1:-1)*this.options.smartEasingAmount,this.duration=this.duration/2):(this.endVal=s,this.finalEndVal=null),this.useEasing=null===this.finalEndVal&&this.options.useEasing},r.prototype.start=function(s){this.error||(this.options.onStartCallback&&this.options.onStartCallback(),s&&(this.options.onCompleteCallback=s),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},r.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},r.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},r.prototype.update=function(s){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(s),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,null==this.finalEndVal&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},r.prototype.printValue=function(s){var o;if(this.el){var e=this.formattingFn(s);null!==(o=this.options.plugin)&&void 0!==o&&o.render?this.options.plugin.render(this.el,e):"INPUT"===this.el.tagName?this.el.value=e:"text"===this.el.tagName||"tspan"===this.el.tagName?this.el.textContent=e:this.el.innerHTML=e}},r.prototype.ensureNumber=function(s){return"number"==typeof s&&!isNaN(s)},r.prototype.validateValue=function(s){var o=Number(s);return this.ensureNumber(o)?o:(this.error="[CountUp] invalid start or end value: ".concat(s),null)},r.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},r.prototype.parse=function(s){var o=function(a){return a.replace(/([.,'\xa0 ])/g,"\\$1")},e=o(this.options.separator),i=o(this.options.decimal),n=s.replace(new RegExp(e,"g"),"").replace(new RegExp(i,"g"),".");return parseFloat(n)},r}(),H=c(177);let et=(()=>{class r{constructor(o,e,i){this.el=o,this.zone=e,this.platformId=i,this.options={},this.reanimateOnClick=!0,this.complete=new t.bkB}onClick(){this.reanimateOnClick&&this.animate()}ngOnChanges(o){if(!(0,H.UE)(this.platformId))return;const{options:e,endVal:i}=o;this.countUp?(void 0!==e?.currentValue||void 0!==i?.currentValue)&&(void 0!==e?.currentValue?this.initAndRun():(this.options.startVal||(this.options.startVal=this.countUp.frameVal),this.zone.runOutsideAngular(()=>{this.countUp.update(this.endVal)}))):this.initAndRun()}animate(){this.zone.runOutsideAngular(()=>{this.countUp.reset(),this.countUp.start(()=>{this.zone.run(()=>{this.complete.emit()})})})}initAndRun(){this.zone.runOutsideAngular(()=>{this.countUp=new tt(this.el.nativeElement,this.endVal,this.options),this.options.enableScrollSpy||this.animate()})}}return r.\u0275fac=function(o){return new(o||r)(t.rXU(t.aKT),t.rXU(t.SKi),t.rXU(t.Agw))},r.\u0275dir=t.FsC({type:r,selectors:[["","countUp",""]],hostBindings:function(o,e){1&o&&t.bIt("click",function(){return e.onClick()})},inputs:{endVal:[0,"countUp","endVal"],options:"options",reanimateOnClick:"reanimateOnClick"},outputs:{complete:"complete"},standalone:!1,features:[t.OA$]}),r})(),K=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.$C({type:r}),r.\u0275inj=h.G2t({imports:[[]]}),r})();var F=c(9417),Q=c(9560),Y=c(1171),U=c(4956),ot=c(3391),S=c(4972),x=c(8132),L=c(956),k=c(467),j=c(4819),$=c(8790),G=c(1949),Ot=c(4981),rt=c(9327),mt=c(2998),ft=c(1413),vt=c(6977),Mt=c(4330),Tt=c(3445);const Pt=["app-script-dev-info",""],Lt=()=>["settings/add"];function Ft(r,s){if(1&r){const o=t.RV6();t.j41(0,"div",0)(1,"div",7),t.EFF(2," settings "),t.k0s(),t.j41(3,"div",8),t.EFF(4,"Migliori script per utilizzo"),t.k0s(),t.j41(5,"div",9)(6,"div",10),t.bIt("chartInit",function(i){h.eBV(o);const n=t.XpG();return h.Njj(n.eChartsService.addInstanceToResizeEvent(i,n.eChartsScope))}),t.k0s()()()}if(2&r){const o=t.XpG();t.R7$(6),t.Y8G("options",o.chartOptions)("autoResize",!1)}}let It=(()=>{var r;class s{constructor(e,i){this.eChartsService=e,this.breakpointObserver=i,this.loading=!0,this.filterEvent=new t.bkB,this.chartOptions={},this.smallScreen=!0,this.eChartsScope="script-dev",this.componentDestroyed=new ft.B,this.smallScreen=this.breakpointObserver.isMatched([rt.Rp.XSmall,rt.Rp.Small])}ngOnInit(){this.breakpointObserver.observe([rt.Rp.XSmall,rt.Rp.Small]).pipe((0,vt.Q)(this.componentDestroyed)).subscribe(e=>{this.smallScreen=e.matches}),this.eChartsService.setResizeChartEvent(this.componentDestroyed,this.eChartsScope)}ngOnChanges(e){e.loading&&!this.loading&&this.setData()}setData(){const i=Object.values(this.scriptStats).sort((n,a)=>a.entities.length-n.entities.length).slice(0,10);this.chartOptions=function Dt(r,s){return{grid:{top:30,bottom:30,right:"2%",left:"5%"},xAxis:{type:"category",data:s,show:!1},yAxis:{type:"value",minInterval:50},tooltip:{show:!0,trigger:"axis",axisPointer:{type:"none"},borderWidth:1,borderColor:"var(--bs-border-color)",textStyle:{color:"inherit"}},series:{data:r,name:"Installazioni",type:"bar",label:{position:"inside",show:!0},color:"rgba(72, 100, 254, 0.85)",emphasis:{itemStyle:{color:"rgba(114, 138, 255, 0.85)"}},itemStyle:{borderRadius:[7,7,0,0]}}}}(i.map(n=>n.entities.length),i.map(n=>this.scriptList.find(a=>a.id===n.scriptId)?.name||""))}ngOnDestroy(){this.componentDestroyed.next(),this.componentDestroyed.complete(),this.eChartsService.clearResizeInstances(this.eChartsScope)}static#t=r=()=>(this.\u0275fac=function(i){return new(i||s)(t.rXU(mt.El),t.rXU(Mt.Q))},this.\u0275cmp=t.VBU({type:s,selectors:[["","app-script-dev-info",""]],inputs:{scriptList:"scriptList",scriptStats:"scriptStats",loading:"loading"},outputs:{filterEvent:"filterEvent"},standalone:!1,features:[t.OA$],attrs:Pt,decls:14,vars:5,consts:[[1,"flat-container","px-3","pt-3","position-relative","d-flex","flex-column","overflow-hidden"],[1,"flat-container","px-3","px-md-4","py-3","tips","d-none","d-sm-block"],[1,"text-justify","d-none","d-sm-block","mb-0"],[1,"d-flex","utilities"],[1,"d-block","flex-grow-1","input-filter",3,"textEvent","disabled","enterKeyOnly"],[1,"d-block","new-script","btn","btn-primary","flex-shrink-0",3,"routerLink"],[1,"d-none","d-sm-inline"],[1,"material-icons","chart-icon","d-block","position-absolute"],[1,"mb-0","h5"],[1,"position-relative","flex-grow-1","chart-container"],["echarts","",1,"d-block","h-100",3,"chartInit","options","autoResize"]],template:function(i,n){1&i&&(t.nVh(0,Ft,7,2,"div",0),t.j41(1,"div")(2,"div",1)(3,"p",2),t.EFF(4," Tramite questo pannello \xe8 possibile gestire e visualizzare le statistiche dei "),t.j41(5,"em"),t.EFF(6,"propri script"),t.k0s(),t.EFF(7,". La tabella con l'elenco dei propri script fornisce le principali informazioni su ogni script inserito. Cliccando sul numero di installazioni, viene visualizzato un modal contenente i dettagli di tutti i siti e gli account che utilizzano lo script. Le tre icone finali consentono rispettivamente di cancellare la cache, aggiornare le impostazioni e rimuovere definitivamente lo script. "),t.k0s()(),t.j41(8,"div",3)(9,"app-input-filter-text",4),t.bIt("textEvent",function(p){return n.filterEvent.emit(p)}),t.k0s(),t.j41(10,"a",5),t.EFF(11,"Nuovo "),t.j41(12,"span",6),t.EFF(13,"script"),t.k0s()()()()),2&i&&(t.vxM(n.smallScreen?-1:0),t.R7$(9),t.Y8G("disabled",n.loading)("enterKeyOnly",!0),t.R7$(),t.Y8G("routerLink",t.lJ4(4,Lt)))},dependencies:[Tt.b,S.$P,x.Wk],styles:["#custom-filter[_ngcontent-%COMP%]{padding-right:calc(.5rem + 26px)}.reset-custom-filter[_ngcontent-%COMP%]{top:calc(50% - 10px);right:5px;z-index:6}.chart-container[_ngcontent-%COMP%]{min-height:150px}.chart-icon[_ngcontent-%COMP%]{right:0;top:0;transform:translate(40%,-40%) rotate(46deg);font-size:8rem;opacity:.2;animation:_ngcontent-%COMP%_chart-icon-animation 1s 1}@keyframes _ngcontent-%COMP%_chart-icon-animation{0%{transform:translate(40%,-40%) rotate(46deg)}to{transform:translate(40%,-40%) rotate(406deg)}}.tips[_ngcontent-%COMP%]{margin-bottom:1rem}.utilities[_ngcontent-%COMP%]{margin:0 1rem}.utilities[_ngcontent-%COMP%]   .new-script[_ngcontent-%COMP%]{margin-left:1rem}.utilities[_ngcontent-%COMP%]   .input-filter[_ngcontent-%COMP%], .utilities[_ngcontent-%COMP%]   .new-script[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013}@media (min-width: 768px){.utilities[_ngcontent-%COMP%]{margin:0}}@media (min-width: 960px){.tips[_ngcontent-%COMP%]{margin-bottom:1.5rem}.utilities[_ngcontent-%COMP%]   .new-script[_ngcontent-%COMP%]{margin-left:1.5rem}}"]}))}return r(),s})();var X=c(7515),Z=c(9944),kt=c(9986),_t=c(2881),gt=c(1148),pt=c(8488),Ct=c(4310),d=c(4033);const v=["modal"];function f(r,s){if(1&r&&(t.j41(0,"p"),t.EFF(1," Al fine di garantire che gli script vengano serviti rapidamente e per evitare carichi eccessivi sul server, i file javascript indicati nelle impostazioni degli script sono sottoposti a cache. In genere, ci\xf2 non rappresenta un problema e non viene notato n\xe9 dagli sviluppatori n\xe9 dagli utenti. "),t.k0s(),t.j41(2,"h6",4),t.EFF(3,"Aggiornare la cache"),t.k0s(),t.j41(4,"p"),t.EFF(5," Quando viene effettuata una modifica al file javascript, se questo \xe8 caricato sulle repositories di git appositamente pensate e dedicate a questo scopo, la cache dello script viene "),t.j41(6,"strong"),t.EFF(7,"automaticamente"),t.k0s(),t.EFF(8," aggiornata. Nonostante ci\xf2, in alcune limitate circostanze, ad esempio in caso di modifiche "),t.j41(9,"em"),t.EFF(10,"breaking"),t.k0s(),t.EFF(11," o essenziali per il funzionamento dello script stesso, pu\xf2 risultare necessario forzare l'aggiornamento della cache. Per fare ci\xf2, \xe8 sufficiente cliccare sul pulsante "),t.j41(12,"em"),t.EFF(13,"Conferma"),t.k0s(),t.EFF(14," nel footer, dopo essersi accertati che lo script selezionato sia effettivamente quello di cui si desidera aggiornare la cache."),t.nrm(15,"br")(16,"br"),t.EFF(17," Lo strumento di aggiornamento della cache comporta un carico aggiuntivo sul server, per questo motivo dovrebbe essere "),t.j41(18,"strong"),t.EFF(19,"usato con parsimonia."),t.k0s()(),t.j41(20,"h6",4),t.EFF(21,"Riepologo script"),t.k0s(),t.j41(22,"p"),t.EFF(23," Proseguendo, verr\xe0 aggiornata la cache dello script "),t.nrm(24,"span",5),t.EFF(25,". "),t.k0s()),2&r){const o=t.XpG();t.R7$(24),t.Y8G("innerText",o.scriptName)}}function C(r,s){if(1&r){const o=t.RV6();t.j41(0,"button",6),t.bIt("click",function(){h.eBV(o),t.XpG();const i=t.sdS(1);return h.Njj(i.close("Close click"))}),t.EFF(1,"Annulla"),t.k0s(),t.j41(2,"button",7),t.bIt("click",function(){h.eBV(o);const i=t.XpG();return h.Njj(i.deleteCache())}),t.EFF(3,"Conferma"),t.k0s()}if(2&r){const o=t.XpG();t.R7$(2),t.Y8G("disabled",o.pendingRequest)}}let y=(()=>{var r;class s{constructor(e,i){this.scriptDevService=e,this.toastService=i,this.scriptName="",this.cachePendingEvent=new t.bkB,this.pendingRequest=!1}open(){this.modalComponent.open()}deleteCache(){var e=this;return(0,k.A)(function*(){e.pendingRequest?e.toastService.advice(X.d.REQUEST_PENDING):(e.pendingRequest=!0,e.cachePendingEvent.emit(e.scriptId),e.modalComponent.close("Cache button click"),void 0!==e.scriptId&&(yield e.scriptDevService.deleteScriptCache(e.scriptId))?e.toastService.show({content:`Cache dello script <strong>${e.scriptName}</strong> cancellata correttamente!`}):e.toastService.advice(X.d.GENERIC),e.pendingRequest=!1,e.cachePendingEvent.emit())})()}static#t=r=()=>(this.\u0275fac=function(i){return new(i||s)(t.rXU(j.u),t.rXU(pt.f))},this.\u0275cmp=t.VBU({type:s,selectors:[["app-script-dev-cache"]],viewQuery:function(i,n){if(1&i&&t.GBs(v,5),2&i){let a;t.mGM(a=t.lsd())&&(n.modalComponent=a.first)}},inputs:{scriptName:"scriptName",scriptId:"scriptId"},outputs:{cachePendingEvent:"cachePendingEvent"},standalone:!1,decls:4,vars:1,consts:[["modal",""],["title","Cache degli script",3,"disableCloseButton"],["appModalBody",""],["appModalFooter",""],[1,"fst-italic"],[1,"text-uppercase","fw-bold","text-decoration-underline",3,"innerText"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"]],template:function(i,n){1&i&&(t.j41(0,"app-modal",1,0),t.DNE(2,f,26,1,"ng-template",2)(3,C,4,1,"ng-template",3),t.k0s()),2&i&&t.Y8G("disableCloseButton",!0)},dependencies:[gt.z,Ct.d,d.I],encapsulation:2}))}return r(),s})();const O=["modal"];function w(r,s){if(1&r){const o=t.RV6();t.j41(0,"p"),t.EFF(1," In alcune occasioni, pu\xf2 rendersi necessario procedere alla cancellazione di uno script, per sostituirlo interamente oppure perch\xe9 divenuto obsoleto a seguito dello sviluppo di altre funzioni analoghe. Per queste e altre situazioni, viene lasciata allo sviluppatore la possibilit\xe0 di rimuovere uno script creato. Una volta confermata, la cancellazione \xe8 "),t.j41(2,"strong"),t.EFF(3,"definitiva e irreversibile"),t.k0s(),t.EFF(4,". "),t.k0s(),t.j41(5,"h6",5),t.EFF(6,"Cancellare uno script"),t.k0s(),t.j41(7,"p"),t.EFF(8," La cancellazione di uno script comporta la sua "),t.j41(9,"strong"),t.EFF(10,"completa rimozione"),t.k0s(),t.EFF(11," dall'elenco degli script installabili e dai forum che lo hanno gi\xe0 inserito. L'azione non pu\xf2 essere annullata, occorre pertanto prestare particolare attenzione e procedere solo se si ha la "),t.j41(12,"strong"),t.EFF(13,"certezza"),t.k0s(),t.EFF(14," di voler eliminare lo script selezionato. "),t.k0s(),t.j41(15,"p",6)(16,"input",7),t.mxI("ngModelChange",function(i){h.eBV(o);const n=t.XpG(2);return t.DH7(n.checkboxConfirm,i)||(n.checkboxConfirm=i),h.Njj(i)}),t.k0s(),t.j41(17,"label",8),t.EFF(18," Cancella definitivamente lo script "),t.nrm(19,"span",9),t.EFF(20),t.k0s()()}if(2&r){const o=t.XpG(2);t.R7$(16),t.R50("ngModel",o.checkboxConfirm),t.R7$(3),t.Y8G("innerText",o.scriptName),t.R7$(),t.SpI(" (ID: ",o.scriptId,") ")}}function it(r,s){if(1&r&&(t.j41(0,"div",4)(1,"p",10),t.EFF(2," Cancellazione script "),t.nrm(3,"span",11),t.k0s(),t.j41(4,"p"),t.EFF(5," Per terminare la cancellazione dello script "),t.nrm(6,"strong",12),t.EFF(7),t.j41(8,"em"),t.EFF(9,"Cancella"),t.k0s(),t.EFF(10,". "),t.j41(11,"strong"),t.EFF(12,"Non vi saranno altre richieste di conferma!"),t.k0s(),t.EFF(13," Procedi solo se sei sicuro di voler rimuovere "),t.j41(14,"strong"),t.EFF(15,"definitivamente"),t.k0s(),t.EFF(16," lo script. "),t.k0s()()),2&r){const o=t.XpG(2);t.R7$(3),t.Y8G("innerText",o.scriptName),t.R7$(3),t.Y8G("innerText",o.scriptName),t.R7$(),t.SpI(" (ID: ",o.scriptId,") premi sul pulsante ")}}function Rt(r,s){if(1&r&&t.nVh(0,w,21,3)(1,it,17,3,"div",4),2&r){const o=t.XpG();t.vxM(o.continueConfirm?1:0)}}function Yt(r,s){if(1&r){const o=t.RV6();t.j41(0,"button",15),t.bIt("click",function(){h.eBV(o);const i=t.XpG(2);return h.Njj(i.continueConfirm=i.checkboxConfirm)}),t.EFF(1,"Procedi"),t.k0s()}if(2&r){const o=t.XpG(2);t.Y8G("disabled",o.pendingRequest||!o.checkboxConfirm)}}function zt(r,s){if(1&r){const o=t.RV6();t.j41(0,"button",15),t.bIt("click",function(){h.eBV(o);const i=t.XpG(2);return h.Njj(i.deleteScript())}),t.EFF(1,"Cancella"),t.k0s()}if(2&r){const o=t.XpG(2);t.Y8G("disabled",o.pendingRequest)}}function Xt(r,s){if(1&r){const o=t.RV6();t.j41(0,"button",13),t.bIt("click",function(){h.eBV(o),t.XpG();const i=t.sdS(1);return h.Njj(i.close("Close click"))}),t.EFF(1,"Annulla"),t.k0s(),t.nVh(2,Yt,2,1,"button",14)(3,zt,2,1,"button",14)}if(2&r){const o=t.XpG();t.R7$(2),t.vxM(o.continueConfirm?3:2)}}let Wt=(()=>{var r;class s{constructor(e,i){this.toastService=e,this.scriptDevService=i,this.deletionPendingEvent=new t.bkB,this.deletionScriptEvent=new t.bkB,this.pendingRequest=!1,this.checkboxConfirm=!1,this.continueConfirm=!1}open(){this.reset(),this.modalComponent.open()}reset(){this.checkboxConfirm=!1,this.continueConfirm=!1}deleteScript(){var e=this;return(0,k.A)(function*(){e.checkboxConfirm&&e.continueConfirm&&e.scriptId&&(e.pendingRequest?e.toastService.advice(X.d.REQUEST_PENDING):(e.pendingRequest=!0,e.deletionPendingEvent.emit(e.scriptId),e.modalComponent.close("Delete button click"),void 0!==e.scriptId&&(yield e.scriptDevService.deleteScript(e.scriptId))?(e.toastService.show({content:`Script <strong>${e.scriptName}</strong> cancellato correttamente!`}),e.deletionScriptEvent.emit(e.scriptId)):e.toastService.advice(X.d.GENERIC),e.pendingRequest=!1,e.deletionPendingEvent.emit()))})()}static#t=r=()=>(this.\u0275fac=function(i){return new(i||s)(t.rXU(pt.f),t.rXU(j.u))},this.\u0275cmp=t.VBU({type:s,selectors:[["app-script-dev-deletion"]],viewQuery:function(i,n){if(1&i&&t.GBs(O,5),2&i){let a;t.mGM(a=t.lsd())&&(n.modalComponent=a.first)}},inputs:{scriptName:"scriptName",scriptId:"scriptId"},outputs:{deletionPendingEvent:"deletionPendingEvent",deletionScriptEvent:"deletionScriptEvent"},standalone:!1,decls:4,vars:1,consts:[["modal",""],["title","Cancellazione script",3,"disableCloseButton"],["appModalBody",""],["appModalFooter",""],[1,"alert","alert-danger","mb-0"],[1,"fst-italic"],[1,"form-check"],["type","checkbox","id","remove-script",1,"form-check-input",3,"ngModelChange","ngModel"],["for","remove-script",1,"form-check-label"],[1,"text-uppercase","fw-bold","text-decoration-underline",3,"innerText"],[1,"text-center","fw-bold"],[1,"text-uppercase",3,"innerText"],[3,"innerText"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"]],template:function(i,n){1&i&&(t.j41(0,"app-modal",1,0),t.DNE(2,Rt,2,1,"ng-template",2)(3,Xt,4,1,"ng-template",3),t.k0s()),2&i&&t.Y8G("disableCloseButton",!0)},dependencies:[F.Zm,F.BC,F.vS,gt.z,Ct.d,d.I],encapsulation:2}))}return r(),s})();var Ht=c(180),z=function(r){return r[r.TITLE=0]="TITLE",r[r.STATUS=1]="STATUS",r[r.DOCS=2]="DOCS",r[r.PREVIEW=3]="PREVIEW",r[r.TYPE=4]="TYPE",r[r.INSTALLATIONS=5]="INSTALLATIONS",r}(z||{}),Kt=c(3654);function wt(r,s,o){switch(o){case z.TITLE:return r.sort((e,i)=>e.name.localeCompare(i.name));case z.INSTALLATIONS:{const e=Object.values(s).sort((n,a)=>a.entities.length-n.entities.length),i={};for(const[n,a]of e.entries())i[a.scriptId]=n+1;return r.sort((n,a)=>(i[n.id]||1e3)-(i[a.id]||1e3))}case z.DOCS:return r.sort((e,i)=>e.docs.link&&!i.docs.link?-1:!e.docs.link&&i.docs.link?1:0);case z.PREVIEW:return r.sort((e,i)=>e.preview&&!i.preview?-1:!e.preview&&i.preview?1:0);case z.STATUS:return r.sort((e,i)=>e.privacy.hidden&&!i.privacy.hidden?1:!e.privacy.hidden&&i.privacy.hidden?-1:0);case z.TYPE:return r.sort((e,i)=>e.type===G.Hy.ALL?-1:i.type===G.Hy.ALL?1:e.type===G.Hy.FORUM?-1:i.type===G.Hy.FORUM?1:0);default:return r}}var Qt=c(6350),Zt=c(2807),Jt=c(5652),qt=c(9716);const te=["cacheModal"],ee=["installationModal"],ie=["deletionModal"],ne=["app-script-dev-list",""],se=r=>({"touch-device":r}),oe=r=>({"border-bottom":r}),re=r=>({focus:r}),ae=(r,s)=>[r,s],le=r=>({"cache-pending":r}),ce=r=>({placement:r}),pe=(r,s,o)=>({$implicit:r,f:s,scriptId:o}),de=r=>({"del-pending":r}),ue=()=>[10,10],he=(r,s)=>({placement:r,offset:s}),Bt=r=>["settings",r],me=r=>({"mt-2":r}),fe=r=>({"edit-required text-danger":r}),ve=()=>[42,10],_e=(r,s,o)=>({placement:r,offset:s,theme:o});function ge(r,s){1&r&&(t.j41(0,"li",13),t.nrm(1,"app-loader",18),t.k0s())}function Ce(r,s){1&r&&(t.j41(0,"li",19)(1,"div",20),t.EFF(2," Nessuno script trovato! "),t.k0s()())}function ye(r,s){if(1&r&&t.nVh(0,Ce,3,0,"li",19),2&r){const o=t.XpG();t.vxM(0===o.renderScriptList.length?0:-1)}}function Se(r,s){if(1&r&&t.nrm(0,"div",27),2&r){const o=s.$implicit;t.Y8G("ngClass",o?"text-success":"text-danger")("innerText",o?"assignment_turned_in":"highlight_off")}}function Ee(r,s){1&r&&t.nrm(0,"div",29),2&r&&t.Y8G("innerText","Forum")}function be(r,s){if(1&r&&t.nrm(0,"div",30),2&r){const o=t.XpG().$implicit,e=t.XpG(2);t.Y8G("ngClass",t.eq3(2,me,o.type===e.scriptType.ALL))("innerText","Utenti")}}function xe(r,s){if(1&r){const o=t.RV6();t.j41(0,"a",44),t.bIt("click",function(){h.eBV(o);const i=t.XpG().$implicit,n=t.XpG(2);return h.Njj(n.installationNumberClick(i))}),t.k0s()}if(2&r){const o=t.XpG().$implicit,e=t.XpG(2);t.Y8G("innerText",e.scriptStats[o.id].entities.length)}}function Oe(r,s){1&r&&(t.j41(0,"div"),t.EFF(1,"-"),t.k0s())}function De(r,s){1&r&&t.eu8(0)}function Me(r,s){if(1&r){const o=t.RV6();t.j41(0,"a",41),t.bIt("click",function(){h.eBV(o);const i=t.XpG().$implicit,n=t.XpG(2);return h.Njj(n.installationNumberClick(i))}),t.j41(1,"div",42),t.EFF(2,"poll"),t.k0s(),t.j41(3,"div"),t.EFF(4,"Installazioni"),t.k0s()()}}function Te(r,s){if(1&r){const o=t.RV6();t.j41(0,"li",22)(1,"div",23),t.nrm(2,"a",24)(3,"div",25),t.k0s(),t.nrm(4,"div",26),t.Z7z(5,Se,1,2,"div",27,t.fX1),t.j41(7,"div",28),t.nVh(8,Ee,1,1,"div",29),t.nVh(9,be,1,4,"div",30),t.k0s(),t.j41(10,"div",31),t.nVh(11,xe,1,1,"a",32)(12,Oe,2,0,"div"),t.k0s(),t.j41(13,"div")(14,"div",33)(15,"a",34),t.bIt("click",function(){const i=h.eBV(o).$implicit,n=t.XpG(2);return h.Njj(n.cacheIconClick(i))}),t.EFF(16,"sync"),t.k0s(),t.DNE(17,De,1,0,"ng-container",35),t.j41(18,"a",36),t.bIt("click",function(){const i=h.eBV(o).$implicit,n=t.XpG(2);return h.Njj(n.deleteScript(i))}),t.EFF(19,"delete"),t.k0s()(),t.j41(20,"div",37,4),t.bIt("openChange",function(){h.eBV(o);const i=t.sdS(21),n=t.XpG(2);return h.Njj(n.saveOpenedDropdown(i))}),t.j41(22,"div",38),t.EFF(23,"more_vert"),t.k0s(),t.j41(24,"div",39),t.nVh(25,Me,5,0,"a",40),t.j41(26,"a",41),t.bIt("click",function(){const i=h.eBV(o).$implicit,n=t.XpG(2);return h.Njj(n.cacheIconClick(i))}),t.j41(27,"div",42),t.EFF(28,"sync"),t.k0s(),t.j41(29,"div"),t.EFF(30,"Aggiorna cache"),t.k0s()(),t.j41(31,"a",43)(32,"div",42),t.EFF(33,"settings"),t.k0s(),t.j41(34,"div"),t.EFF(35,"Impostazioni"),t.k0s()(),t.j41(36,"a",41),t.bIt("click",function(){const i=h.eBV(o).$implicit,n=t.XpG(2);return h.Njj(n.deleteScript(i))}),t.j41(37,"div",42),t.EFF(38,"delete"),t.k0s(),t.j41(39,"div"),t.EFF(40,"Cancella script"),t.k0s()()()()()()}if(2&r){const o=s.$implicit,e=s.first,i=s.last,n=t.XpG(2),a=t.sdS(21);t.Y8G("ngClass",t.eq3(21,oe,!i)),t.R7$(2),t.Y8G("routerLink",o.type===n.scriptType.USER||o.type===n.scriptType.ALL?n.paths.SCRIPT_USER:n.paths.SCRIPT_FORUM)("queryParams",t.eq3(23,re,o.id))("innerHTML",(o.author.ffuid===n.ffuid?"":"["+o.author.name+"] ")+o.name,t.npT),t.R7$(),t.Y8G("innerText",o.description||"Nessuna descrizione"),t.R7$(),t.Y8G("ngClass",o.privacy.hidden?"badge-red":"badge-green")("innerText",o.privacy.hidden?"Privato":"Pubblico"),t.R7$(),t.Dyx(t.l_i(25,ae,o.docs.link,o.preview)),t.R7$(3),t.vxM(o.type===n.scriptType.FORUM||o.type===n.scriptType.ALL?8:-1),t.R7$(),t.vxM(o.type===n.scriptType.USER||o.type===n.scriptType.ALL?9:-1),t.R7$(2),t.vxM(n.scriptStats[o.id]&&n.scriptStats[o.id].entities.length?11:12),t.R7$(4),t.Y8G("ngClass",t.eq3(28,le,n.cachePendingId===o.id))("tippyProps",t.eq3(30,ce,e?"bottom":"top"))("disableOnTouchDevice",!0),t.R7$(2),t.Y8G("ngTemplateOutlet",a)("ngTemplateOutletContext",t.sMw(32,pe,!(o.privacy.hidden||o.description.length&&o.preview&&o.docs.link),e,o.id)),t.R7$(),t.Y8G("ngClass",t.eq3(36,de,n.deletionPending))("tippyProps",t.l_i(39,he,e?"bottom-end":"top-end",t.lJ4(38,ue)))("disableOnTouchDevice",!0)("disableInstance",n.deletionPending),t.R7$(7),t.vxM(n.scriptStats[o.id]?25:-1),t.R7$(6),t.Y8G("routerLink",t.eq3(42,Bt,o.id))}}function Pe(r,s){if(1&r&&(t.j41(0,"cdk-virtual-scroll-viewport",14)(1,"ul",5),t.DNE(2,Te,41,44,"li",21),t.k0s()()),2&r){const o=t.XpG();t.Y8G("itemSize",88),t.R7$(),t.Y8G("ngClass",t.eq3(3,se,o.isTouch)),t.R7$(),t.Y8G("cdkVirtualForOf",o.renderScriptList)}}function Le(r,s){if(1&r&&(t.j41(0,"a",45)(1,"div",46),t.EFF(2,"settings"),t.k0s()()),2&r){const o=s.$implicit,e=s.f,i=s.scriptId,n=t.XpG();t.Y8G("routerLink",t.eq3(5,Bt,i))("ngClass",t.eq3(7,fe,o))("appTippy",o?n.tippySettingsAlertMessage:n.tippySettingsMessage)("tippyProps",t.sMw(10,_e,e?"bottom-end":"top-end",t.lJ4(9,ve),o?"popover":""))("disableOnTouchDevice",!0)}}let Fe=(()=>{var r;class s{constructor(e,i,n){this.toastService=e,this.scriptFiltersService=i,this.globalsService=n,this.loading=!0,this.deletionScriptEvent=new t.bkB,this.renderScriptList=[],this.sortOptionKeys=z,this.sortOption=z.TITLE,this.scriptType=G.Hy,this.isTouch=kt.CN,this.sortValue=1,this.currentCacheScript={name:""},this.currentDeletionScript={name:""},this.deletionPending=!1,this.paths=Qt.LP,this.tippySettingsAlertMessage="La descrizione, l'anteprima e la guida sono essenziali per comprendere il corretto funzionamento dello script e per metterlo in evidenza agli utenti. Clicca sull'icona per modificare le impostazioni dello script e accertati di aver inserito questi elementi!",this.tippySettingsMessage="Modifica le impostazioni",this.tabs=Kt.QW,this.cdkScrolledIndexChange=new ft.B,this.ffuid=this.globalsService.credentials?.user.ffuid}ngOnChanges(e){if(e.filter){if(!this.filter)return void(e.filter.previousValue&&(this.renderScriptList=this.scriptList));const i=this.scriptFiltersService.createKeywordsRegex(this.filter);this.renderScriptList=this.scriptList.filter(n=>n.name.match(i)||n.description.match(i))}e.loading&&!this.loading&&(this.renderScriptList=this.scriptList,this.renderScriptList=wt(this.renderScriptList,this.scriptStats,this.sortOption))}saveOpenedDropdown(e){e.isOpen()&&(this.openedDropdown=e,this.virtualScrollRef&&this.virtualScrollRef.scrolledIndexChange.pipe((0,vt.Q)(this.cdkScrolledIndexChange)).subscribe(()=>{this.openedDropdown?.close(),this.cdkScrolledIndexChange.next()}))}setSortOption(e){this.sortOption===e?(this.sortValue=-this.sortValue,this.renderScriptList=[...this.renderScriptList.reverse()]):(this.sortValue=e===z.INSTALLATIONS?-1:1,this.sortOption=e,this.renderScriptList=[...wt(this.renderScriptList,this.scriptStats,e)])}cacheIconClick(e){void 0===this.cachePendingId?(this.currentCacheScript={id:e.id,name:e.name},this.cacheModalRef.open()):this.toastService.advice(X.d.REQUEST_PENDING)}installationNumberClick(e){(0,mt.l$)(this.scriptStats,e.id)&&(this.currentInstallationScript={script:e,stats:{forums:this.scriptStats[e.id].entities.filter(i=>i.targetType===G.CB.FORUM).map(i=>i.targetId),users:this.scriptStats[e.id].entities.filter(i=>i.targetType===G.CB.USER).map(i=>i.targetId)}},this.installationModalRef.open())}deleteScript(e){this.deletionPending?this.toastService.advice(X.d.REQUEST_PENDING):e.dependencies.children.length>0?this.toastService.show({content:`Questo script \xe8 richiesto da altri script (<strong>${e.dependencies.children.map(i=>i.name).join(", ")}</strong>).<br>Prima di cancellarlo, elimina le dipendenze!`,level:X.A.WARNING}):(this.currentDeletionScript={id:e.id,name:e.name},this.deletionModalRef.open())}static#t=r=()=>(this.\u0275fac=function(i){return new(i||s)(t.rXU(pt.f),t.rXU(Zt.M),t.rXU(_t.k))},this.\u0275cmp=t.VBU({type:s,selectors:[["","app-script-dev-list",""]],viewQuery:function(i,n){if(1&i&&(t.GBs(te,5),t.GBs(ee,5),t.GBs(ie,5),t.GBs(Z.d6,5)),2&i){let a;t.mGM(a=t.lsd())&&(n.cacheModalRef=a.first),t.mGM(a=t.lsd())&&(n.installationModalRef=a.first),t.mGM(a=t.lsd())&&(n.deletionModalRef=a.first),t.mGM(a=t.lsd())&&(n.virtualScrollRef=a.first)}},inputs:{scriptList:"scriptList",scriptStats:"scriptStats",filter:"filter",loading:"loading"},outputs:{deletionScriptEvent:"deletionScriptEvent"},standalone:!1,features:[t.OA$],attrs:ne,decls:28,vars:16,consts:[["settingsIcon",""],["cacheModal",""],["installationModal",""],["deletionModal",""],["dropdown","ngbDropdown"],[1,"list-unstyled","mb-0","position-relative",3,"ngClass"],[1,"header","bg-dark","text-light","text-uppercase","fw-bold","d-flex","d-md-grid","align-items-center","py-3"],[1,"title","w-100","sortable",3,"click"],[1,"d-none","d-md-inline"],[1,"d-md-none"],[1,"d-none","d-md-block","sortable",3,"click"],[1,"d-none","d-xxl-block","sortable",3,"click"],[1,"d-none","d-xl-block","sortable",3,"click"],[1,"loader","py-3"],["scrollWindow","",1,"mw-100",3,"itemSize"],[3,"cachePendingEvent","scriptName","scriptId"],[3,"scriptWithStats"],[3,"deletionPendingEvent","deletionScriptEvent","scriptName","scriptId"],["message","Recupero lista script"],[1,"empty","p-3"],[1,"alert","alert-primary","text-center","mb-0"],["class","item d-flex d-md-grid align-items-center position-relative",3,"ngClass",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"item","d-flex","d-md-grid","align-items-center","position-relative",3,"ngClass"],[1,"title","d-flex","flex-column","min-w-0","mw-100","me-auto","pe-2","pe-md-0"],[1,"d-block","me-auto","fw-bold","text-truncate","mw-100",3,"routerLink","queryParams","innerHTML"],[1,"fs-sm","text-muted","text-truncate","mw-100",3,"innerText"],[1,"badge","flat-badge","mx-auto","d-none","d-md-flex",3,"ngClass","innerText"],[1,"material-icons-outlined","d-none","d-xxl-block","mx-auto",3,"ngClass","innerText"],[1,"mx-auto","d-none","d-md-block"],[1,"badge","flat-badge","badge-blue",3,"innerText"],[1,"badge","flat-badge","badge-indigo",3,"ngClass","innerText"],[1,"d-none","d-xl-block","mx-auto"],[1,"d-block","cursor-pointer",3,"innerText"],[1,"d-none","d-md-flex","align-items-center","justify-content-center","utilities"],["role","button","appTippy","Aggiorna la cache",1,"d-block","material-icons-outlined","me-2",3,"click","ngClass","tippyProps","disableOnTouchDevice"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["role","button","appTippy","Cancella lo script",1,"d-block","material-icons-outlined","ms-2",3,"click","ngClass","tippyProps","disableOnTouchDevice","disableInstance"],["ngbDropdown","","placement","left auto","display","dynamic","container","body",1,"d-md-none","dropdown-no-caret","utility-dropdown",3,"openChange"],["ngbDropdownToggle","",1,"d-block","material-icons","cursor-pointer"],["ngbDropdownMenu","",1,"dropdown-material-icons"],["role","button",1,"dropdown-item","d-flex","align-items-center"],["role","button",1,"dropdown-item","d-flex","align-items-center",3,"click"],[1,"material-icons-outlined","d-block"],[1,"dropdown-item","d-flex","align-items-center",3,"routerLink"],[1,"d-block","cursor-pointer",3,"click","innerText"],[1,"d-block",3,"routerLink","ngClass","appTippy","tippyProps","disableOnTouchDevice"],[1,"d-block","material-icons-outlined","m-icon"]],template:function(i,n){if(1&i){const a=t.RV6();t.j41(0,"ul",5)(1,"li",6)(2,"div",7),t.bIt("click",function(){return h.eBV(a),h.Njj(n.setSortOption(n.sortOptionKeys.TITLE))}),t.j41(3,"span",8),t.EFF(4,"Titolo"),t.k0s(),t.j41(5,"span",9),t.EFF(6,"Lista script"),t.k0s()(),t.j41(7,"div",10),t.bIt("click",function(){return h.eBV(a),h.Njj(n.setSortOption(n.sortOptionKeys.STATUS))}),t.EFF(8,"Status"),t.k0s(),t.j41(9,"div",11),t.bIt("click",function(){return h.eBV(a),h.Njj(n.setSortOption(n.sortOptionKeys.DOCS))}),t.EFF(10,"Guida"),t.k0s(),t.j41(11,"div",11),t.bIt("click",function(){return h.eBV(a),h.Njj(n.setSortOption(n.sortOptionKeys.PREVIEW))}),t.EFF(12,"Preview"),t.k0s(),t.j41(13,"div",10),t.bIt("click",function(){return h.eBV(a),h.Njj(n.setSortOption(n.sortOptionKeys.TYPE))}),t.EFF(14,"Tipo"),t.k0s(),t.j41(15,"div",12),t.bIt("click",function(){return h.eBV(a),h.Njj(n.setSortOption(n.sortOptionKeys.INSTALLATIONS))}),t.EFF(16,"Uso"),t.k0s()(),t.nVh(17,ge,2,0,"li",13)(18,ye,1,1),t.k0s(),t.nVh(19,Pe,3,5,"cdk-virtual-scroll-viewport",14),t.DNE(20,Le,3,14,"ng-template",null,0,t.C5r),t.j41(22,"app-script-dev-cache",15,1),t.bIt("cachePendingEvent",function(m){return h.eBV(a),h.Njj(n.cachePendingId=m)}),t.k0s(),t.nrm(24,"app-script-dev-stats-details",16,2),t.j41(26,"app-script-dev-deletion",17,3),t.bIt("deletionPendingEvent",function(m){return h.eBV(a),h.Njj(n.deletionPending=void 0!==m)})("deletionScriptEvent",function(){return h.eBV(a),h.Njj(n.deletionScriptEvent.emit(!0))}),t.k0s()}2&i&&(t.AVh("touch-device",n.isTouch),t.Y8G("ngClass",n.sortValue>0?"asc":"desc"),t.R7$(2),t.BMQ("data-sorted",n.sortOption===n.sortOptionKeys.TITLE),t.R7$(5),t.BMQ("data-sorted",n.sortOption===n.sortOptionKeys.STATUS),t.R7$(2),t.BMQ("data-sorted",n.sortOption===n.sortOptionKeys.DOCS),t.R7$(2),t.BMQ("data-sorted",n.sortOption===n.sortOptionKeys.PREVIEW),t.R7$(2),t.BMQ("data-sorted",n.sortOption===n.sortOptionKeys.TYPE),t.R7$(2),t.BMQ("data-sorted",n.sortOption===n.sortOptionKeys.INSTALLATIONS),t.R7$(2),t.vxM(n.loading?17:18),t.R7$(2),t.vxM(!n.loading&&n.renderScriptList.length>0?19:-1),t.R7$(3),t.Y8G("scriptName",n.currentCacheScript.name)("scriptId",n.currentCacheScript.id),t.R7$(2),t.Y8G("scriptWithStats",n.currentInstallationScript),t.R7$(2),t.Y8G("scriptName",n.currentDeletionScript.name)("scriptId",n.currentDeletionScript.id))},dependencies:[N.YU,N.T3,Jt.V,ot.tg,ot.do,ot.U0,x.Wk,y,Wt,Ht.P,Z.yg,Z.E$,Z.d6,Z.Zr,qt.e],styles:['ul[_ngcontent-%COMP%]:not(.touch-device)   li[_ngcontent-%COMP%]:not(.header):not(.loader):not(.empty){background-color:#fff}ul[_ngcontent-%COMP%]:not(.touch-device)   li[_ngcontent-%COMP%]:not(.header):not(.loader):not(.empty):hover{background-color:rgb(var(--bs-light-rgb))}ul[_ngcontent-%COMP%]:not(.touch-device)   .utilities[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(.edit-required):not(.cache-pending):not(.del-pending){opacity:.5;transition:opacity .2s}ul[_ngcontent-%COMP%]:not(.touch-device)   .utilities[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(.edit-required):not(.cache-pending):not(.del-pending):hover{opacity:1}.utilities[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(.edit-required){color:inherit}li[_ngcontent-%COMP%]:not(.loader):not(.empty){padding-left:.75rem;padding-right:.5rem}li[_ngcontent-%COMP%]:not(.loader):not(.empty):not(.header){height:88px}li[_ngcontent-%COMP%]:not(.loader):not(.empty).header{padding-right:1rem}.sortable[_ngcontent-%COMP%]{position:relative;cursor:pointer}.sortable[_ngcontent-%COMP%]:before, .sortable[_ngcontent-%COMP%]:after{transition:opacity .2s;position:absolute;right:0;width:0;height:0;content:"";opacity:.4;border-right:4px solid transparent;border-left:4px solid transparent}.sortable[_ngcontent-%COMP%]:before{bottom:4px;border-top:4px solid #fff}.sortable[_ngcontent-%COMP%]:after{top:4px;border-bottom:4px solid #fff}.asc[_ngcontent-%COMP%]   .sortable[data-sorted=true][_ngcontent-%COMP%]:after{opacity:1}.desc[_ngcontent-%COMP%]   .sortable[data-sorted=true][_ngcontent-%COMP%]:before{opacity:1}.sortable[_ngcontent-%COMP%]:not([data-sorted=true]):hover:before, .sortable[_ngcontent-%COMP%]:not([data-sorted=true]):hover:after{opacity:.6}@media (min-width: 576px){li[_ngcontent-%COMP%]:not(.loader){padding-left:1rem;padding-right:.75rem}}@media (min-width: 768px){li[_ngcontent-%COMP%]:not(.loader){grid-template-columns:3fr repeat(3,1fr);padding-left:4%}li[_ngcontent-%COMP%]:not(.loader).header > div[_ngcontent-%COMP%]:not(.title){text-align:center}li[_ngcontent-%COMP%]:not(.loader):not(.empty){padding-left:1.5rem;padding-right:.5rem!important}}@media (min-width: 1200px){li[_ngcontent-%COMP%]:not(.loader){grid-template-columns:40% repeat(4,15%);padding-left:0;padding-right:0}}@media (min-width: 1400px){li[_ngcontent-%COMP%]:not(.loader){grid-template-columns:40% repeat(6,10%)}}.edit-required[_ngcontent-%COMP%]   .m-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotation 2s infinite}.cache-pending[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fullRotation 1s linear infinite}.del-pending[_ngcontent-%COMP%], .del-pending[_ngcontent-%COMP%]:hover{opacity:.1!important;cursor:initial!important}@keyframes _ngcontent-%COMP%_rotation{50%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_fullRotation{0%{transform:rotate(0)}to{transform:rotate(-360deg)}}']}))}return r(),s})();var Ie=c(1378);const ke=["app-script-dev-stats",""];let Re=(()=>{var r;class s{constructor(e){this.globalsService=e,this.publicScriptCreated=0,this.totalInstall=0,this.userInstall=0,this.forumInstall=0,this.countOptions={separator:"."}}ngOnChanges(e){if(e.scriptList&&this.scriptList.length){const i=this.globalsService.credentials?.user.ffuid||"";this.publicScriptCreated=this.scriptList.filter(n=>n.author.ffuid===i&&!1===n.privacy.hidden).length}if(e.scriptStats&&!(0,Ie.ZF)(this.scriptStats)){this.totalInstall=0;const i=[],n=[];for(const a of Object.values(this.scriptStats)){this.totalInstall+=a.entities.length;for(const p of a.entities)p.targetType===G.CB.USER&&-1===i.indexOf(p.targetId)?i.push(p.targetId):-1===n.indexOf(p.targetId)&&n.push(p.targetId)}this.userInstall=i.length,this.forumInstall=n.length}}static#t=r=()=>(this.\u0275fac=function(i){return new(i||s)(t.rXU(_t.k))},this.\u0275cmp=t.VBU({type:s,selectors:[["","app-script-dev-stats",""]],inputs:{scriptList:"scriptList",scriptStats:"scriptStats"},standalone:!1,features:[t.OA$],attrs:ke,decls:32,vars:11,consts:[[1,"flat-container","d-flex","align-items-center"],[1,"fw-normal","lh-1","text-success",3,"countUp","reanimateOnClick"],[1,"text-muted","fs-xs","text-uppercase"],[1,"d-block","material-icons-outlined","text-success"],[1,"fw-normal","lh-1","text-primary",3,"countUp","options","reanimateOnClick"],[1,"d-block","material-icons","text-primary"],[1,"fw-normal","lh-1","text-indigo",3,"countUp","options","reanimateOnClick"],[1,"d-block","material-icons","text-indigo"],[1,"fw-normal","lh-1","text-danger",3,"countUp","options","reanimateOnClick"],[1,"d-block","material-icons-outlined","text-danger"]],template:function(i,n){1&i&&(t.j41(0,"div",0)(1,"div")(2,"h2",1),t.EFF(3," 0 "),t.k0s(),t.j41(4,"div",2),t.EFF(5,"script pubblici creati"),t.k0s()(),t.j41(6,"div",3),t.EFF(7," integration_instructions "),t.k0s()(),t.j41(8,"div",0)(9,"div")(10,"h2",4),t.EFF(11," 0 "),t.k0s(),t.j41(12,"div",2),t.EFF(13,"installazioni"),t.k0s()(),t.j41(14,"div",5),t.EFF(15,"speed"),t.k0s()(),t.j41(16,"div",0)(17,"div")(18,"h2",6),t.EFF(19," 0 "),t.k0s(),t.j41(20,"div",2),t.EFF(21,"forum unici"),t.k0s()(),t.j41(22,"div",7),t.EFF(23,"public"),t.k0s()(),t.j41(24,"div",0)(25,"div")(26,"h2",8),t.EFF(27," 0 "),t.k0s(),t.j41(28,"div",2),t.EFF(29,"utenti unici"),t.k0s()(),t.j41(30,"div",9),t.EFF(31,"people_alt"),t.k0s()()),2&i&&(t.R7$(2),t.Y8G("countUp",n.publicScriptCreated)("reanimateOnClick",!1),t.R7$(8),t.Y8G("countUp",n.totalInstall)("options",n.countOptions)("reanimateOnClick",!1),t.R7$(8),t.Y8G("countUp",n.forumInstall)("options",n.countOptions)("reanimateOnClick",!1),t.R7$(8),t.Y8G("countUp",n.userInstall)("options",n.countOptions)("reanimateOnClick",!1))},dependencies:[et],styles:[".flat-container[_ngcontent-%COMP%]{padding:2rem}.flat-container[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{letter-spacing:.2em}.flat-container[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%], .flat-container[_ngcontent-%COMP%]   .material-icons-outlined[_ngcontent-%COMP%]{font-size:35px;margin-left:auto}"]}))}return r(),s})(),Ve=(()=>{var r;class s{constructor(e,i,n){this.scriptDevService=e,this.scriptListService=i,this.viewportScroller=n,this.scriptList=[],this.scriptStats={},this.loading=!0}ngOnInit(){var e=this;return(0,k.A)(function*(){yield e.setData()})()}setData(){var e=this;return(0,k.A)(function*(){e.loading=!0;const[i,n]=yield Promise.all([e.scriptListService.getScriptsByPermissions([G.Eq.EDIT]),e.scriptDevService.getStats()]);e.scriptList=i.list,e.scriptStats=n.reduce((a,p)=>(a[p.scriptId]=p,a),{}),e.loading=!1})()}refresh(){var e=this;return(0,k.A)(function*(){e.viewportScroller.scrollToPosition([0,0]),yield e.setData()})()}static#t=r=()=>(this.\u0275fac=function(i){return new(i||s)(t.rXU(j.u),t.rXU($.j),t.rXU(H.Xr))},this.\u0275cmp=t.VBU({type:s,selectors:[["app-script-dev"]],standalone:!1,decls:5,vars:9,consts:[["pageTitle","Sviluppo script"],["app-script-dev-stats","",1,"stats","d-grid",3,"scriptList","scriptStats"],[1,"page-container"],["app-script-dev-info","",1,"info","d-grid",3,"filterEvent","scriptList","scriptStats","loading"],["app-script-dev-list","",1,"list","flat-container","overflow-hidden",3,"deletionScriptEvent","scriptList","scriptStats","loading","filter"]],template:function(i,n){1&i&&(t.nrm(0,"app-breadcrumb",0)(1,"div",1),t.j41(2,"div",2)(3,"div",3),t.bIt("filterEvent",function(p){return n.filter=p}),t.k0s(),t.j41(4,"div",4),t.bIt("deletionScriptEvent",function(){return n.refresh()}),t.k0s()()),2&i&&(t.R7$(),t.Y8G("scriptList",n.scriptList)("scriptStats",n.scriptStats),t.R7$(2),t.Y8G("scriptList",n.scriptList)("scriptStats",n.scriptStats)("loading",n.loading),t.R7$(),t.Y8G("scriptList",n.scriptList)("scriptStats",n.scriptStats)("loading",n.loading)("filter",n.filter))},dependencies:[Ot.D,It,Fe,Re],styles:[".page-container[_ngcontent-%COMP%], .list[_ngcontent-%COMP%]{margin-top:1rem}.stats[_ngcontent-%COMP%], .info[_ngcontent-%COMP%]{row-gap:1rem}@media (min-width: 768px){.stats[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);column-gap:1rem}}@media (min-width: 960px){.page-container[_ngcontent-%COMP%], .list[_ngcontent-%COMP%]{margin-top:1.5rem}.stats[_ngcontent-%COMP%], .info[_ngcontent-%COMP%]{column-gap:1.5rem;row-gap:1.5rem}}@media (min-width: 1400px){.stats[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}.info[_ngcontent-%COMP%]{grid-template-columns:3fr 2fr}}"]}))}return r(),s})();var je=c(7418),we=c(4196),Be=c(1694),Ge=c(1245),Ae=c(3410),Ue=c(151),$e=c(4838),Gt=c(4689),V=c(1571),Ne=c(5727),Ye=c(2928),dt=c(6754),at=c(6612),yt=c(1489),Vt=c(8489),ze=c(5440);function At(r,s,o){var e=ze.yh.createCanvas(),i=s.getWidth(),n=s.getHeight(),a=e.style;return a&&(a.position="absolute",a.left="0",a.top="0",a.width=i+"px",a.height=n+"px",e.setAttribute("data-zr-dom-id",r)),e.width=i*o,e.height=n*o,e}const jt=function(r){function s(o,e,i){var a,n=r.call(this)||this;n.motionBlur=!1,n.lastFrameAlpha=.7,n.dpr=1,n.virtual=!1,n.config={},n.incremental=!1,n.zlevel=0,n.maxRepaintRectCount=5,n.__dirty=!0,n.__firstTimePaint=!0,n.__used=!1,n.__drawIndex=0,n.__startIndex=0,n.__endIndex=0,n.__prevStartIndex=null,n.__prevEndIndex=null,i=i||Gt.Y5,"string"==typeof o?a=At(o,e,i):V.isObject(o)&&(o=(a=o).id),n.id=o,n.dom=a;var p=a.style;return p&&(V.disableUserSelect(a),a.onselectstart=function(){return!1},p.padding="0",p.margin="0",p.borderWidth="0"),n.painter=e,n.dpr=i,n}return(0,Ne.C6)(s,r),s.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},s.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},s.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},s.prototype.setUnpainted=function(){this.__firstTimePaint=!0},s.prototype.createBackBuffer=function(){var o=this.dpr;this.domBack=At("back-"+this.id,this.painter,o),this.ctxBack=this.domBack.getContext("2d"),1!==o&&this.ctxBack.scale(o,o)},s.prototype.createRepaintRects=function(o,e,i,n){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var E,a=[],p=this.maxRepaintRectCount,m=!1,_=new yt.A(0,0,0,0);function g(D){if(D.isFinite()&&!D.isZero())if(0===a.length)(R=new yt.A(0,0,0,0)).copy(D),a.push(R);else{for(var J=!1,Et=1/0,ut=0,q=0;q<a.length;++q){var A=a[q];if(A.intersect(D)){var lt=new yt.A(0,0,0,0);lt.copy(A),lt.union(D),a[q]=lt,J=!0;break}if(m){_.copy(D),_.union(A);var bt=_.width*_.height-D.width*D.height-A.width*A.height;bt<Et&&(Et=bt,ut=q)}}var R;m&&(a[ut].union(D),J=!0),J||((R=new yt.A(0,0,0,0)).copy(D),a.push(R)),m||(m=a.length>=p)}}for(var u=this.__startIndex;u<this.__endIndex;++u)if(b=o[u]){var M=b.shouldBePainted(i,n,!0,!0);(I=b.__isRendered&&(b.__dirty&Vt.M||!M)?b.getPrevPaintRect():null)&&g(I);var T=M&&(b.__dirty&Vt.M||!b.__isRendered)?b.getPaintRect():null;T&&g(T)}for(u=this.__prevStartIndex;u<this.__prevEndIndex;++u){var b,I;M=(b=e[u])&&b.shouldBePainted(i,n,!0,!0),!b||M&&b.__zr||!b.__isRendered||(I=b.getPrevPaintRect())&&g(I)}do{for(E=!1,u=0;u<a.length;)if(a[u].isZero())a.splice(u,1);else{for(var P=u+1;P<a.length;)a[u].intersect(a[P])?(E=!0,a[u].union(a[P]),a.splice(P,1)):P++;u++}}while(E);return this._paintRects=a,a},s.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},s.prototype.resize=function(o,e){var i=this.dpr,n=this.dom,a=n.style,p=this.domBack;a&&(a.width=o+"px",a.height=e+"px"),n.width=o*i,n.height=e*i,p&&(p.width=o*i,p.height=e*i,1!==i&&this.ctxBack.scale(i,i))},s.prototype.clear=function(o,e,i){var n=this.dom,a=this.ctx,p=n.width,m=n.height;e=e||this.clearColor;var _=this.motionBlur&&!o,g=this.lastFrameAlpha,u=this.dpr,b=this;_&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(n,0,0,p/u,m/u));var M=this.domBack;function I(T,E,P,D){if(a.clearRect(T,E,P,D),e&&"transparent"!==e){var R=void 0;V.isGradientObject(e)?(R=(e.global||e.__width===P&&e.__height===D)&&e.__canvasGradient||(0,dt.Ff)(a,e,{x:0,y:0,width:P,height:D}),e.__canvasGradient=R,e.__width=P,e.__height=D):V.isImagePatternObject(e)&&(e.scaleX=e.scaleX||u,e.scaleY=e.scaleY||u,R=(0,at.ZQ)(a,e,{dirty:function(){b.setUnpainted(),b.painter.refresh()}})),a.save(),a.fillStyle=R||e,a.fillRect(T,E,P,D),a.restore()}_&&(a.save(),a.globalAlpha=g,a.drawImage(M,T,E,P,D),a.restore())}!i||_?I(0,0,p,m):i.length&&V.each(i,function(T){I(T.x*u,T.y*u,T.width*u,T.height*u)})},s}(Ye.A);var We=c(9024),He=c(8372),nt=314159;const qe=function(){function r(s,o,e,i){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var n=!s.nodeName||"CANVAS"===s.nodeName.toUpperCase();this._opts=e=V.extend({},e||{}),this.dpr=e.devicePixelRatio||Gt.Y5,this._singleCanvas=n,this.root=s,s.style&&(V.disableUserSelect(s),s.innerHTML=""),this.storage=o;var p=this._zlevelList;this._prevDisplayList=[];var m=this._layers;if(n){var g=s,u=g.width,b=g.height;null!=e.width&&(u=e.width),null!=e.height&&(b=e.height),this.dpr=e.devicePixelRatio||1,g.width=u*this.dpr,g.height=b*this.dpr,this._width=u,this._height=b;var M=new jt(g,this,this.dpr);M.__builtin__=!0,M.initContext(),m[nt]=M,M.zlevel=nt,p.push(nt),this._domRoot=s}else{this._width=(0,dt.YC)(s,0,e),this._height=(0,dt.YC)(s,1,e);var _=this._domRoot=function Ze(r,s){var o=document.createElement("div");return o.style.cssText=["position:relative","width:"+r+"px","height:"+s+"px","padding:0","margin:0","border-width:0"].join(";")+";",o}(this._width,this._height);s.appendChild(_)}}return r.prototype.getType=function(){return"canvas"},r.prototype.isSingleCanvas=function(){return this._singleCanvas},r.prototype.getViewportRoot=function(){return this._domRoot},r.prototype.getViewportRootOffset=function(){var s=this.getViewportRoot();if(s)return{offsetLeft:s.offsetLeft||0,offsetTop:s.offsetTop||0}},r.prototype.refresh=function(s){var o=this.storage.getDisplayList(!0),e=this._prevDisplayList,i=this._zlevelList;this._redrawId=Math.random(),this._paintList(o,e,s,this._redrawId);for(var n=0;n<i.length;n++){var p=this._layers[i[n]];!p.__builtin__&&p.refresh&&p.refresh(0===n?this._backgroundColor:null)}return this._opts.useDirtyRect&&(this._prevDisplayList=o.slice()),this},r.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},r.prototype._paintHoverList=function(s){var o=s.length,e=this._hoverlayer;if(e&&e.clear(),o){for(var n,i={inHover:!0,viewWidth:this._width,viewHeight:this._height},a=0;a<o;a++){var p=s[a];p.__inHover&&(e||(e=this._hoverlayer=this.getLayer(1e5)),n||(n=e.ctx).save(),(0,at.V$)(n,p,i,a===o-1))}n&&n.restore()}},r.prototype.getHoverLayer=function(){return this.getLayer(1e5)},r.prototype.paintOne=function(s,o){(0,at.Xi)(s,o)},r.prototype._paintList=function(s,o,e,i){if(this._redrawId===i){e=e||!1,this._updateLayerStatus(s);var n=this._doPaintList(s,o,e),a=n.finished,p=n.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),p&&this._paintHoverList(s),a)this.eachLayer(function(_){_.afterBrush&&_.afterBrush()});else{var m=this;(0,We.A)(function(){m._paintList(s,o,e,i)})}}},r.prototype._compositeManually=function(){var s=this.getLayer(nt).ctx,o=this._domRoot.width,e=this._domRoot.height;s.clearRect(0,0,o,e),this.eachBuiltinLayer(function(i){i.virtual&&s.drawImage(i.dom,0,0,o,e)})},r.prototype._doPaintList=function(s,o,e){for(var i=this,n=[],a=this._opts.useDirtyRect,p=0;p<this._zlevelList.length;p++){var _=this._layers[this._zlevelList[p]];_.__builtin__&&_!==this._hoverlayer&&(_.__dirty||e)&&n.push(_)}for(var g=!0,u=!1,b=function(T){var E=n[T],P=E.ctx,D=a&&E.createRepaintRects(s,o,M._width,M._height),R=e?E.__startIndex:E.__drawIndex,J=!e&&E.incremental&&Date.now,Et=J&&Date.now(),ut=E.zlevel===M._zlevelList[0]?M._backgroundColor:null;if(E.__startIndex===E.__endIndex)E.clear(!1,ut,D);else if(R===E.__startIndex){var q=s[R];(!q.incremental||!q.notClear||e)&&E.clear(!1,ut,D)}-1===R&&(console.error("For some unknown reason. drawIndex is -1"),R=E.__startIndex);var A,lt=function(bt){var $t={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i._width,viewHeight:i._height};for(A=R;A<E.__endIndex;A++){var Nt=s[A];if(Nt.__inHover&&(u=!0),i._doPaintEl(Nt,E,a,bt,$t,A===E.__endIndex-1),J&&Date.now()-Et>15)break}$t.prevElClipPaths&&P.restore()};if(D)if(0===D.length)A=E.__endIndex;else for(var ct=M.dpr,ht=0;ht<D.length;++ht){var st=D[ht];P.save(),P.beginPath(),P.rect(st.x*ct,st.y*ct,st.width*ct,st.height*ct),P.clip(),lt(st),P.restore()}else P.save(),lt(),P.restore();E.__drawIndex=A,E.__drawIndex<E.__endIndex&&(g=!1)},M=this,I=0;I<n.length;I++)b(I);return He.A.wxa&&V.each(this._layers,function(T){T&&T.ctx&&T.ctx.draw&&T.ctx.draw()}),{finished:g,needsRefreshHover:u}},r.prototype._doPaintEl=function(s,o,e,i,n,a){var p=o.ctx;if(e){var m=s.getPaintRect();(!i||m&&m.intersect(i))&&((0,at.V$)(p,s,n,a),s.setPrevPaintRect(m))}else(0,at.V$)(p,s,n,a)},r.prototype.getLayer=function(s,o){this._singleCanvas&&!this._needsManuallyCompositing&&(s=nt);var e=this._layers[s];return e||((e=new jt("zr_"+s,this,this.dpr)).zlevel=s,e.__builtin__=!0,this._layerConfig[s]?V.merge(e,this._layerConfig[s],!0):this._layerConfig[s-.01]&&V.merge(e,this._layerConfig[s-.01],!0),o&&(e.virtual=o),this.insertLayer(s,e),e.initContext()),e},r.prototype.insertLayer=function(s,o){var e=this._layers,i=this._zlevelList,n=i.length,a=this._domRoot,p=null,m=-1;if(!e[s]&&function Qe(r){return!(!r||!r.__builtin__&&("function"!=typeof r.resize||"function"!=typeof r.refresh))}(o)){if(n>0&&s>i[0]){for(m=0;m<n-1&&!(i[m]<s&&i[m+1]>s);m++);p=e[i[m]]}if(i.splice(m+1,0,s),e[s]=o,!o.virtual)if(p){var _=p.dom;_.nextSibling?a.insertBefore(o.dom,_.nextSibling):a.appendChild(o.dom)}else a.firstChild?a.insertBefore(o.dom,a.firstChild):a.appendChild(o.dom);o.painter||(o.painter=this)}},r.prototype.eachLayer=function(s,o){for(var e=this._zlevelList,i=0;i<e.length;i++){var n=e[i];s.call(o,this._layers[n],n)}},r.prototype.eachBuiltinLayer=function(s,o){for(var e=this._zlevelList,i=0;i<e.length;i++){var n=e[i],a=this._layers[n];a.__builtin__&&s.call(o,a,n)}},r.prototype.eachOtherLayer=function(s,o){for(var e=this._zlevelList,i=0;i<e.length;i++){var n=e[i],a=this._layers[n];a.__builtin__||s.call(o,a,n)}},r.prototype.getLayers=function(){return this._layers},r.prototype._updateLayerStatus=function(s){function o(u){n&&(n.__endIndex!==u&&(n.__dirty=!0),n.__endIndex=u)}if(this.eachBuiltinLayer(function(u,b){u.__dirty=u.__used=!1}),this._singleCanvas)for(var e=1;e<s.length;e++)if((i=s[e]).zlevel!==s[e-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}var p,m,n=null,a=0;for(m=0;m<s.length;m++){var i,_=(i=s[m]).zlevel,g=void 0;p!==_&&(p=_,a=0),i.incremental?((g=this.getLayer(_+.001,this._needsManuallyCompositing)).incremental=!0,a=1):g=this.getLayer(_+(a>0?.01:0),this._needsManuallyCompositing),g.__builtin__||V.logError("ZLevel "+_+" has been used by unkown layer "+g.id),g!==n&&(g.__used=!0,g.__startIndex!==m&&(g.__dirty=!0),g.__startIndex=m,g.__drawIndex=g.incremental?-1:m,o(m),n=g),i.__dirty&Vt.M&&!i.__inHover&&(g.__dirty=!0,g.incremental&&g.__drawIndex<0&&(g.__drawIndex=m))}o(m),this.eachBuiltinLayer(function(u,b){!u.__used&&u.getElementCount()>0&&(u.__dirty=!0,u.__startIndex=u.__endIndex=u.__drawIndex=0),u.__dirty&&u.__drawIndex<0&&(u.__drawIndex=u.__startIndex)})},r.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},r.prototype._clearLayer=function(s){s.clear()},r.prototype.setBackgroundColor=function(s){this._backgroundColor=s,V.each(this._layers,function(o){o.setUnpainted()})},r.prototype.configLayer=function(s,o){if(o){var e=this._layerConfig;e[s]?V.merge(e[s],o,!0):e[s]=o;for(var i=0;i<this._zlevelList.length;i++){var n=this._zlevelList[i];n!==s&&n!==s+.01||V.merge(this._layers[n],e[s],!0)}}},r.prototype.delLayer=function(s){var o=this._layers,e=this._zlevelList,i=o[s];i&&(i.dom.parentNode.removeChild(i.dom),delete o[s],e.splice(V.indexOf(e,s),1))},r.prototype.resize=function(s,o){if(this._domRoot.style){var e=this._domRoot;e.style.display="none";var i=this._opts,n=this.root;if(null!=s&&(i.width=s),null!=o&&(i.height=o),s=(0,dt.YC)(n,0,i),o=(0,dt.YC)(n,1,i),e.style.display="",this._width!==s||o!==this._height){for(var a in e.style.width=s+"px",e.style.height=o+"px",this._layers)this._layers.hasOwnProperty(a)&&this._layers[a].resize(s,o);this.refresh(!0)}this._width=s,this._height=o}else{if(null==s||null==o)return;this._width=s,this._height=o,this.getLayer(nt).resize(s,o)}return this},r.prototype.clearLayer=function(s){var o=this._layers[s];o&&o.clear()},r.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},r.prototype.getRenderedCanvas=function(s){if(this._singleCanvas&&!this._compositeManually)return this._layers[nt].dom;var o=new jt("image",this,(s=s||{}).pixelRatio||this.dpr);o.initContext(),o.clear(!1,s.backgroundColor||this._backgroundColor);var e=o.ctx;if(s.pixelRatio<=this.dpr){this.refresh();var i=o.dom.width,n=o.dom.height;this.eachLayer(function(u){u.__builtin__?e.drawImage(u.dom,0,0,i,n):u.renderToCanvas&&(e.save(),u.renderToCanvas(e),e.restore())})}else for(var a={inHover:!1,viewWidth:this._width,viewHeight:this._height},p=this.storage.getDisplayList(!0),m=0,_=p.length;m<_;m++)(0,at.V$)(e,p[m],a,m===_-1);return o.dom},r.prototype.getWidth=function(){return this._width},r.prototype.getHeight=function(){return this._height},r}();Be.Y([Ue.a,$e.a,Ae.a,function ti(r){r.registerPainter("canvas",qe)}]);const ei=[{path:"",component:Ve},{path:"settings",loadChildren:()=>Promise.all([c.e(602),c.e(76),c.e(887)]).then(c.bind(c,2887)).then(r=>r.ScriptDevSettingsModule),data:{title:"Settings"}}];let ii=(()=>{var r;class s{static#t=r=()=>(this.\u0275fac=function(i){return new(i||s)},this.\u0275mod=t.$C({type:s}),this.\u0275inj=h.G2t({imports:[B._,N.MD,K,F.YN,Q.M,Y.iZ,U.Q,ot.zH,S.sN.forRoot({echarts:Ge}),x.iI.forChild(ei),L.$,je.H,we.u,Z.E9]}))}return r(),s})()},4196:(xt,W,c)=>{c.d(W,{u:()=>et});var B=c(1465),N=c(2200),t=c(1171),h=c(4956),l=c(9944),tt=c(2615),H=c(3664);let et=(()=>{var K;class F{static#t=K=()=>(this.\u0275fac=function(U){return new(U||F)},this.\u0275mod=H.$C({type:F}),this.\u0275inj=tt.G2t({imports:[B.B,N.MD,t.iZ,h.Q,l.E9]}))}return K(),F})()},4819:(xt,W,c)=>{c.d(W,{u:()=>Q});var B=c(467),N=c(6660),t=c(2881),h=c(2998),l=c(639),tt=c(8790),H=c(5613),et=c(7184),K=c(6582),F=c(2615);let Q=(()=>{var Y;class U{constructor(S,x,L,k,j,$){this.graphqlService=S,this.globalsService=x,this.forumService=L,this.userService=k,this.scriptListService=j,this.toolsService=$,this.cache={},this.statsDetailsCache={},this.profileSubscription=this.globalsService.profileObservable.subscribe(G=>{this.ffuid=G?.user.ffuid})}getStats(){var S=this;return(0,B.A)(function*(){if(!S.ffuid)return[];if(S.cache[S.ffuid])return S.cache[S.ffuid];const x=(yield S.graphqlService.query({query:l.Hc})).data;return S.cache[S.ffuid]=x.scriptStats})()}deleteScriptCache(S){var x=this;return(0,B.A)(function*(){return(yield x.graphqlService.mutate({mutation:l.bc,variables:{scriptId:S}})).data.delCache})()}getScriptStatsDetails(S){var x=this;return(0,B.A)(function*(){const L=`${x.ffuid}-${S.script.id}`;if((0,h.l$)(x.statsDetailsCache,L))return x.statsDetailsCache[L];const[k,j]=yield Promise.all([S.stats.users.length>0?x.userService.getDetailsFromUids(S.stats.users):[],S.stats.forums.length>0?x.forumService.getDomains(S.stats.forums):[]]);return x.statsDetailsCache[L]={users:k,forums:j}})()}upsertScript(S,x){var L=this;return(0,B.A)(function*(){const k=(yield L.graphqlService.mutate({mutation:l.mD,variables:{...S,scriptId:x}})).data.scriptUpsert;return k&&(L.scriptListService.clearCache(),L.toolsService.refreshList()),k})()}deleteScript(S){var x=this;return(0,B.A)(function*(){const L=(yield x.graphqlService.mutate({mutation:l.KO,variables:{scriptId:S}})).data.delScript;return L&&(x.scriptListService.clearCache(),x.toolsService.refreshList()),L})()}updateScriptPermissions(S){var x=this;return(0,B.A)(function*(){if(0===S.length)return!0;const L=et.gO(S.map((j,$)=>({operation:{name:"scriptPermission",alias:`scriptPermission${$}`},variables:{[`scriptId${$}`]:{name:"scriptId",type:"String!",value:j.scriptId},[`targetId${$}`]:{name:"targetId",type:"String!",value:j.targetId},[`action${$}`]:{name:"action",type:"ScripPermissionActionEnum!",value:j.action},[`level${$}`]:{name:"level",type:"ScripPermissionEnum!",value:j.level}}}))),k=(yield x.graphqlService.mutate({mutation:L.query,variables:L.variables})).data;return Object.values(k).every(Boolean)})()}ngOnDestroy(){this.profileSubscription.unsubscribe()}static#t=Y=()=>(this.\u0275fac=function(x){return new(x||U)(F.KVO(h.Pp),F.KVO(t.k),F.KVO(N.p),F.KVO(H.D),F.KVO(tt.j),F.KVO(K.H))},this.\u0275prov=F.jDH({token:U,factory:U.\u0275fac,providedIn:"root"}))}return Y(),U})()}}]);