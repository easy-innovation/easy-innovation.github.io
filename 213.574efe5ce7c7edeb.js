"use strict";(self.webpackChunkpages=self.webpackChunkpages||[]).push([[213],{977:(R,E,a)=>{a.r(E),a.d(E,{ScriptSettingsModule:()=>ve});var k=a(1625),h=a(2200),F=a(6589),j=a(1171),g=a(9417),x=a(6310),b=a(4956),v=a(8132),P=a(6448),p=a(467),d=a(7515),m=a(2881),u=a(6350),_=a(8790),I=a(2099),B=a(6733),S=a(1949),G=a(7673),O=a(5558),V=a(8488),C=a(2998),e=a(3664),l=a(2615),N=a(7705),y=a(3694),U=a(4981),L=a(6148),T=a(5652),$=a(4791),X=a(1148),D=a(4310);const Y=["modal"];function A(n,r){1&n&&(e.j41(0,"p"),e.EFF(1," Il pannello di impostazioni degli script consente di "),e.j41(2,"strong"),e.EFF(3,"gestire gli aspetti personalizzabili"),e.k0s(),e.EFF(4," degli script installati su un forum o un profilo. "),e.k0s(),e.j41(5,"h6",3),e.EFF(6,"Competenze richieste"),e.k0s(),e.j41(7,"p"),e.EFF(8," A differenza dei precedenti sistemi, che prevedevano l'inserimento di codice nei vari pannelli amministrativi, con EasyScript non \xe8 richiesta da parte dell'account utente o dell'amministratore "),e.j41(9,"strong"),e.EFF(10,"alcuna conoscenza"),e.k0s(),e.EFF(11," in ambito di sviluppo, al pi\xf9 viene consigliato di leggere attentamente le varie "),e.j41(12,"strong"),e.EFF(13,"guide degli script"),e.k0s(),e.EFF(14,", al fine di comprenderne il corretto funzionamento. "),e.k0s(),e.j41(15,"h6",3),e.EFF(16,"Tipi di campo generici"),e.k0s(),e.j41(17,"p"),e.EFF(18," La maggior parte dei campi si presenta come "),e.j41(19,"strong"),e.EFF(20,"input o textarea"),e.k0s(),e.EFF(21," in cui possono essere inseriti valori numerici o testuali. Tali campi possono essere soggetti a "),e.j41(22,"strong"),e.EFF(23,"limiti di valore o di numero dei caratteri"),e.k0s(),e.EFF(24," ammessi, a discrezione del creatore dello script e in funzione del loro utilizzo. Inoltre, comunemente \xe8 possibile incontrare normali "),e.j41(25,"strong"),e.EFF(26,"select"),e.k0s(),e.EFF(27," o "),e.j41(28,"strong"),e.EFF(29,"checkbox"),e.k0s(),e.EFF(30,". I primi consentono di selezionare un'opzione tra un elenco prestabilito, mentre i secondi permettono di abilitare o disabilitare una determinata funzione. Alcuni campi sono stati pensati appositamente per i circuiti, come la "),e.j41(31,"strong"),e.EFF(32,"lista utenti"),e.k0s(),e.EFF(33," o la "),e.j41(34,"strong"),e.EFF(35,"lista forum"),e.k0s(),e.EFF(36,". In questi, \xe8 sufficiente iniziare a digitare il nome di un utente o di un forum per avviare la ricerca nel circuito di appartenenza (eventualmente selezionabile dall'apposito select, se presente) e per poterlo scegliere tra quelli proposti nel men\xf9 a tendina che appare. Una volta selezionato, l'utente o il forum apparir\xe0 nella lista sotto l'input di ricerca e potr\xe0 essere rimosso tramite l'icona rossa a forma di "),e.j41(37,"em"),e.EFF(38,"meno"),e.k0s(),e.EFF(39,". "),e.k0s(),e.j41(40,"h6",3),e.EFF(41,"Un campo particolare: l'array"),e.k0s(),e.j41(42,"p",4),e.EFF(43," Una particolarit\xe0 \xe8 rappresentata dai campi "),e.j41(44,"strong"),e.EFF(45,"array"),e.k0s(),e.EFF(46,", ossia dalle liste. Una lista \xe8 semplicemente un insieme ordinato di elementi. Ciascun elemento pu\xf2 contenere uno o pi\xf9 campi personalizzabili. Per "),e.j41(47,"strong"),e.EFF(48,"aggiungere"),e.k0s(),e.EFF(49," un elemento della lista \xe8 sufficiente cliccare sul pulsante blu con l'icona "),e.j41(50,"em"),e.EFF(51,"+"),e.k0s(),e.EFF(52,". Per ogni elemento, in alto a destra sono presenti le seguenti informazioni: "),e.k0s(),e.j41(53,"ul",4)(54,"li")(55,"em"),e.EFF(56,"numero dell'elemento"),e.k0s(),e.EFF(57,": indica il numero progressivo di quell'elemento nella lista; "),e.k0s(),e.j41(58,"li")(59,"em"),e.EFF(60,"freccia verso l'alto"),e.k0s(),e.EFF(61,": consente di spostare l'elemento di una posizione indietro nella lista; "),e.k0s(),e.j41(62,"li")(63,"em"),e.EFF(64,"freccia verso il basso"),e.k0s(),e.EFF(65,": consente di spostare l'elemento di una posizione avanti nella lista; "),e.k0s(),e.j41(66,"li")(67,"em"),e.EFF(68,"x rossa"),e.k0s(),e.EFF(69,": consente di eliminare l'elemento a cui si riferisce. "),e.k0s()(),e.j41(70,"p"),e.EFF(71," Ogni elemento della lista possiede un bordo tratteggiato che assume "),e.j41(72,"strong"),e.EFF(73,"colore verde"),e.k0s(),e.EFF(74," se tutti i campi di quell'elemento soddisfano i requisiti minimi inseriti dallo sviluppatore per poter essere salvati; "),e.j41(75,"strong"),e.EFF(76,"colore rosso"),e.k0s(),e.EFF(77," se, al contrario, vi \xe8 almeno un campo non compilato correttamente."),e.nrm(78,"br"),e.EFF(79," Sebbene al momento non vi siano limiti al numero di elementi che si possono aggiungere nelle liste, si consiglia di usare il buon senso, in quanto un "),e.j41(80,"strong"),e.EFF(81,"numero eccessivo"),e.k0s(),e.EFF(82," di elementi potrebbe aumentare i tempi di caricamento dello script. "),e.k0s(),e.j41(83,"h6",3),e.EFF(84,"Pulsanti disponibili"),e.k0s(),e.j41(85,"p",4),e.EFF(86," In fondo all'area dedicata al form con i vari campi per la personalizzazione dello script sono presenti quattro pulsanti di colore differente: "),e.k0s(),e.j41(87,"ul")(88,"li")(89,"em"),e.EFF(90,"salva"),e.k0s(),e.EFF(91,": questo pulsante consente di salvare le nuove impostazioni inserite; "),e.k0s(),e.j41(92,"li")(93,"em"),e.EFF(94,"annulla"),e.k0s(),e.EFF(95,": questo pulsante annulla la modifica delle impostazioni e indirizza alla pagina contenente la lista degli script; "),e.k0s(),e.j41(96,"li")(97,"em"),e.EFF(98,"ripristina"),e.k0s(),e.EFF(99,": cliccando questo pulsante vengono ripristinati tutti i valori di default delle varie impostazioni; "),e.k0s(),e.j41(100,"li")(101,"em"),e.EFF(102,"valida"),e.k0s(),e.EFF(103,": questo pulsante consente di controllare che i valori inseriti nei vari campi siano conformi alle specifiche richieste, ad esempio, se \xe8 obbligatoria la compilazione di un campo e questo viene lasciato vuoto, cliccando questo pulsante viene mostrato un apposito avviso. "),e.k0s()(),e.j41(104,"h6",3),e.EFF(105,"Icone nella barra a destra"),e.k0s(),e.j41(106,"p",4),e.EFF(107," Negli schermi di dimensioni maggiori, dove \xe8 disponibile pi\xf9 spazio, viene mostrata a destra una barra laterale con alcune "),e.j41(108,"strong"),e.EFF(109,"icone utili"),e.k0s(),e.EFF(110," per la navigazione veloce tra gli elementi della pagina: "),e.k0s(),e.j41(111,"ul",5)(112,"li")(113,"em"),e.EFF(114,"freccia verso l'alto"),e.k0s(),e.EFF(115,": questo pulsante consente di arrivare velocemente in cima alla pagina; "),e.k0s(),e.j41(116,"li")(117,"em"),e.EFF(118,"lampadina"),e.k0s(),e.EFF(119,": questa icona apre il modal contenente i suggerimenti per l'utilizzo dei vari elementi presenti nella pagina; "),e.k0s(),e.j41(120,"li")(121,"em"),e.EFF(122,"chiave inglese"),e.k0s(),e.EFF(123,": questo pulsante consente di arrivare velocemente ai pulsanti presenti sotto al form; "),e.k0s(),e.j41(124,"li")(125,"em"),e.EFF(126,"annulla"),e.k0s(),e.EFF(127,": cliccando questa icona, l'operazione di modifica delle impostazioni dello script viene annullata "),e.j41(128,"strong"),e.EFF(129,"senza salvare alcun cambiamento"),e.k0s(),e.EFF(130," e si viene indirizzati alla pagina contenente la lista di tutti gli script disponibili; "),e.k0s(),e.j41(131,"li")(132,"em"),e.EFF(133,"conferma"),e.k0s(),e.EFF(134,": questa icona consente, se cliccata, di "),e.j41(135,"strong"),e.EFF(136,"salvare le modifiche"),e.k0s(),e.EFF(137," apportate alle impostazioni dello script. "),e.k0s()())}let Q=(()=>{var n;class r{open(){this.modalComponent.open()}static#e=n=()=>(this.\u0275fac=function(t){return new(t||r)},this.\u0275cmp=e.VBU({type:r,selectors:[["app-script-settings-infomodal"]],viewQuery:function(t,i){if(1&t&&e.GBs(Y,5),2&t){let c;e.mGM(c=e.lsd())&&(i.modalComponent=c.first)}},standalone:!1,decls:3,vars:0,consts:[["modal",""],["title","Pannello impostazioni script","size","xl"],["appModalBody",""],[1,"fst-italic"],[1,"mb-1"],[1,"mb-0"]],template:function(t,i){1&t&&(e.j41(0,"app-modal",1,0),e.DNE(2,A,138,0,"ng-template",2),e.k0s())},dependencies:[X.z,D.d],encapsulation:2}))}return n(),r})();var H=a(9888);const J=["app-script-settings-pageinfo",""];function Z(n,r){1&n&&(e.j41(0,"span"),e.EFF(1," salvato, "),e.k0s())}function K(n,r){1&n&&e.EFF(0," compilati i vari campi e premuto sull'apposito pulsante per effettuare il salvataggio, ")}function W(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1," Per maggiori informazioni \xe8 possibile consultare la "),e.j41(2,"a",13),e.EFF(3,"guida"),e.k0s(),e.EFF(4," dello script. "),e.k0s()),2&n){const s=e.XpG();e.R7$(2),e.Y8G("href",s.script.docs.link,e.B4B)}}function q(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1,"Forum:"),e.k0s(),e.nrm(2,"a",17)),2&n){const s=e.XpG(2);e.R7$(2),e.Y8G("href",null==s.forum?null:s.forum.url,e.B4B)("innerHTML",null==s.forum?null:s.forum.subdomain,e.npT)}}function w(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1,"Profilo:"),e.k0s(),e.nrm(2,"a",17)),2&n){const s=e.XpG(2);e.R7$(2),e.Y8G("href",s.credentials.user.url,e.B4B)("innerHTML",s.credentials.user.nickname,e.npT)}}function ee(n,r){if(1&n&&(e.j41(0,"div",14)(1,"div"),e.EFF(2,"Script:"),e.k0s(),e.nrm(3,"a",15),e.k0s(),e.j41(4,"div",16),e.nVh(5,q,3,2)(6,w,3,2),e.k0s()),2&n){const s=e.XpG();e.R7$(3),e.Y8G("innerText",s.script.name)("routerLink",s.isForum?s.paths.SCRIPT_FORUM:s.paths.SCRIPT_USER)("queryParams",s.directLinkParam),e.R7$(2),e.vxM(s.isForum?5:6)}}function te(n,r){1&n&&(e.j41(0,"div",18),e.nrm(1,"span",19),e.k0s(),e.j41(2,"div",18),e.nrm(3,"span",20),e.k0s())}let ie=(()=>{var n;class r{constructor(o,t){this.scriptListService=o,this.globalsService=t,this.isForum=!1,this.directLinkParam={},this.paths=u.LP,this.readMore=H.Z;const i=this.globalsService.credentials;if(!i)throw new Error("Missing credentials!");this.credentials=i}ngOnInit(){this.settingsOptions=this.scriptListService.settingsOptions}saveSettingsOptions(){this.scriptListService.settingsOptions=this.settingsOptions}static#e=n=()=>(this.\u0275fac=function(t){return new(t||r)(e.rXU(_.j),e.rXU(m.k))},this.\u0275cmp=e.VBU({type:r,selectors:[["","app-script-settings-pageinfo",""]],inputs:{modal:"modal",script:"script",isForum:"isForum",forum:"forum",directLinkParam:"directLinkParam"},standalone:!1,attrs:J,decls:51,vars:7,consts:[[1,"flat-container","px-3","px-md-4","py-3","target-info","min-w-0","d-flex","flex-column"],[1,"mb-2"],["role","button",1,"d-sm-none","cursor-pointer",3,"click","innerText"],[1,"my-auto"],[1,"form-check","mb-0","mt-2"],["type","checkbox","id","redirect-back",1,"form-check-input",3,"ngModelChange","ngModel"],["for","redirect-back",1,"form-check-label"],[1,"flat-container","px-3","px-md-4","py-3","tips","min-w-0","d-none","d-sm-block"],[1,"mb-2","h5"],[1,"mb-0","mb-xl-2"],["role","button",1,"cursor-pointer","d-xl-none",3,"click","innerText"],[1,"mb-0","d-none","d-xl-block"],["role","button",1,"cursor-pointer",3,"click","innerText"],["target","_blank",3,"href"],[1,"selected-script","d-flex"],[1,"d-block","text-uppercase","text-truncate","mw-100","ms-1",3,"innerText","routerLink","queryParams"],[1,"selected-target","d-flex"],["target","_blank",1,"d-block","text-uppercase","text-truncate","mw-100","ms-1",3,"href","innerHTML"],[1,"placeholder-glow"],[1,"placeholder","col-10","col-sm-8"],[1,"placeholder","col-8","col-sm-6"]],template:function(t,i){1&t&&(e.j41(0,"div",0)(1,"p",1),e.EFF(2," Questo pannello consente la personalizzazione delle "),e.j41(3,"em"),e.EFF(4,"impostazioni"),e.k0s(),e.EFF(5," dello script selezionato. Alcuni script, per poter funzionare correttamente, "),e.j41(6,"em"),e.EFF(7,"richiedono"),e.k0s(),e.EFF(8," all'amministratore o all'account che li ha installati di specificare alcune "),e.j41(9,"em"),e.EFF(10,"informazioni essenziali"),e.k0s(),e.EFF(11,"; altri script, al contrario, permettono un elevato grado di personalizzazione grazie alle "),e.j41(12,"em"),e.EFF(13,"impostazioni facoltative"),e.k0s(),e.EFF(14,". Una volta "),e.nVh(15,Z,2,0,"span")(16,K,1,0),e.EFF(17," le impostazioni saranno conservate e applicate durante l'esecuzione dello script. "),e.nVh(18,W,5,1,"span"),e.j41(19,"a",2),e.bIt("click",function(){return i.modal.open()}),e.k0s()(),e.j41(20,"div",3),e.nVh(21,ee,7,4)(22,te,4,0),e.j41(23,"div",4)(24,"input",5),e.mxI("ngModelChange",function(f){return e.DH7(i.settingsOptions.redirectAfterSaving,f)||(i.settingsOptions.redirectAfterSaving=f),f}),e.bIt("ngModelChange",function(){return i.saveSettingsOptions()}),e.k0s(),e.j41(25,"label",6),e.EFF(26," Torna alla lista script dopo il salvataggio "),e.k0s()()()(),e.j41(27,"div",7)(28,"div",8),e.EFF(29,"Tips and tricks"),e.k0s(),e.j41(30,"p",9),e.EFF(31," In fondo all'area dedicata al form con i vari campi per la personalizzazione dello script sono presenti quattro pulsanti di colore differente: "),e.j41(32,"em"),e.EFF(33,"salva, annulla, ripristina e valida"),e.k0s(),e.EFF(34,". Il primo consente di "),e.j41(35,"strong"),e.EFF(36,"salvare"),e.k0s(),e.EFF(37," le nuove impostazioni inserite; il secondo "),e.j41(38,"strong"),e.EFF(39,"annulla"),e.k0s(),e.EFF(40," la modifica delle impostazioni e indirizza alla pagina contenente la lista degli script; il terzo "),e.j41(41,"strong"),e.EFF(42,"ripristina"),e.k0s(),e.EFF(43," tutti i valori di default delle varie impostazioni; il quarto consente di "),e.j41(44,"strong"),e.EFF(45,"controllare"),e.k0s(),e.EFF(46," che i valori inseriti nei vari campi siano conformi alle specifiche richieste. "),e.j41(47,"a",10),e.bIt("click",function(){return i.modal.open()}),e.k0s()(),e.j41(48,"p",11),e.EFF(49," Le icone colorate sulla destra permettono una veloce navigazione nella pagina, nonch\xe9 di annullare o salvare le modifiche in qualunque momento! "),e.j41(50,"a",12),e.bIt("click",function(){return i.modal.open()}),e.k0s()()()),2&t&&(e.R7$(15),e.vxM(null!=i.script&&null!=i.script.docs&&i.script.docs.link?15:16),e.R7$(3),e.vxM(i.script&&i.script.docs.link?18:-1),e.R7$(),e.Y8G("innerText",i.readMore),e.R7$(2),e.vxM(i.script?21:22),e.R7$(3),e.R50("ngModel",i.settingsOptions.redirectAfterSaving),e.R7$(23),e.Y8G("innerText",i.readMore),e.R7$(3),e.Y8G("innerText",i.readMore))},dependencies:[g.Zm,g.BC,g.vS,v.Wk],styles:["p[_ngcontent-%COMP%]{text-align:justify}"]}))}return n(),r})();var ne=a(9997);const oe=n=>({"d-none":n});function se(n,r){1&n&&e.nrm(0,"app-loader",0),2&n&&e.Y8G("onlyMessage",!0)}let ae=(()=>{var n;class r{sandboxLoaded(o){o.loading=!1}static#e=n=()=>(this.\u0275fac=function(t){return new(t||r)},this.\u0275cmp=e.VBU({type:r,selectors:[["app-script-settings-sandbox"]],inputs:{sandbox:"sandbox"},standalone:!1,decls:2,vars:8,consts:[["message","Caricamento della sandbox",3,"onlyMessage"],[3,"loadEvent","ngClass","head","body","eventsObservable","initData"]],template:function(t,i){1&t&&(e.nVh(0,se,1,1,"app-loader",0),e.j41(1,"app-sandbox",1),e.bIt("loadEvent",function(){return i.sandboxLoaded(i.sandbox)}),e.k0s()),2&t&&(e.vxM(i.sandbox.loading?0:-1),e.R7$(),e.Y8G("ngClass",e.eq3(6,oe,i.sandbox.loading))("head",i.sandbox.headData)("body",i.sandbox.bodyData)("eventsObservable",i.sandbox.eventObservable)("initData",i.sandbox.initData))},dependencies:[h.YU,T.V,ne.d],encapsulation:2}))}return n(),r})();function re(n,r){1&n&&e.nrm(0,"app-script-settings-sandbox",8),2&n&&e.Y8G("sandbox",r.$implicit)}function le(n,r){1&n&&e.eu8(0)}function ce(n,r){if(1&n){const s=e.RV6();e.j41(0,"div",9,2),e.bIt("cancelEvent",function(){l.eBV(s);const t=e.XpG(2);return l.Njj(t.redirect())})("submitEvent",function(t){l.eBV(s);const i=e.XpG(2);return l.Njj(i.saveSettings(t))})("modelChangeEvent",function(t){l.eBV(s);const i=e.XpG(2);return l.Njj(i.onModelChange(t))})("validityChangeEvent",function(t){l.eBV(s);const i=e.XpG(2);return l.Njj(i.isFormValid=t)}),e.qex(2,10),e.j41(3,"ul",11)(4,"li",12)(5,"button",13),e.bIt("click",function(){l.eBV(s);const t=e.sdS(1);return l.Njj(t.showFieldValidationWithMessage())}),e.j41(6,"div",14),e.EFF(7,"done_all"),e.k0s(),e.j41(8,"div",15),e.EFF(9,"Valida"),e.k0s()()(),e.j41(10,"li",16)(11,"button",17),e.bIt("click",function(){l.eBV(s);const t=e.sdS(1);return l.Njj(t.reset())}),e.j41(12,"div",14),e.EFF(13,"replay"),e.k0s(),e.j41(14,"div",15),e.EFF(15,"Ripristina"),e.k0s()()(),e.j41(16,"li",18),e.DNE(17,le,1,0,"ng-container",19),e.k0s(),e.j41(18,"li",20)(19,"button",21),e.bIt("click",function(){l.eBV(s);const t=e.sdS(1);return l.Njj(t.submit())}),e.j41(20,"div",14),e.EFF(21,"done"),e.k0s(),e.j41(22,"div",15),e.EFF(23,"Salva"),e.k0s()()()(),e.bVm(),e.k0s(),e.j41(24,"app-script-form-utilities",22),e.bIt("tipsEvent",function(){l.eBV(s),e.XpG(2);const t=e.sdS(7);return l.Njj(t.open())})("cancelEvent",function(){l.eBV(s);const t=e.XpG(2);return l.Njj(t.redirect())})("saveEvent",function(){l.eBV(s);const t=e.sdS(1);return l.Njj(t.submit())}),e.k0s()}if(2&n){const s=e.sdS(1),o=e.XpG(2),t=e.sdS(9);e.Y8G("schema",o.scriptSchema)("model",o.scriptModel)("defaultModel",o.scriptDefaultModel)("validateSchema",!0)("enableModelChangeEvent",o.sandboxes.length>0),e.R7$(17),e.Y8G("ngTemplateOutlet",t),e.R7$(2),e.Y8G("disabled",!s.form.valid),e.R7$(5),e.Y8G("isFormValid",s.form.valid)}}function pe(n,r){1&n&&e.eu8(0)}function de(n,r){if(1&n){const s=e.RV6();e.j41(0,"div",23),e.DNE(1,pe,1,0,"ng-container",19),e.k0s(),e.j41(2,"app-script-form-utilities",24),e.bIt("tipsEvent",function(){l.eBV(s),e.XpG(2);const t=e.sdS(7);return l.Njj(t.open())})("cancelEvent",function(){l.eBV(s);const t=e.XpG(2);return l.Njj(t.redirect())}),e.k0s()}if(2&n){e.XpG(2);const s=e.sdS(9);e.R7$(),e.Y8G("ngTemplateOutlet",s),e.R7$(),e.Y8G("hasForm",!1)}}function me(n,r){if(1&n&&(e.Z7z(0,re,1,1,"app-script-settings-sandbox",8,e.fX1),e.nVh(2,ce,25,8),e.nVh(3,de,3,2)),2&n){const s=e.XpG();e.Dyx(s.sandboxes),e.R7$(2),e.vxM(s.scriptSchema?2:-1),e.R7$(),e.vxM(s.sandboxes.length>0&&!s.scriptSchema?3:-1)}}function ue(n,r){1&n&&e.nrm(0,"app-loader",7),2&n&&e.Y8G("message","Recupero informazioni script")}function ge(n,r){if(1&n){const s=e.RV6();e.j41(0,"button",25),e.bIt("click",function(){l.eBV(s);const t=e.XpG();return l.Njj(t.redirect())}),e.j41(1,"div",14),e.EFF(2,"clear"),e.k0s(),e.j41(3,"div",15),e.EFF(4,"Annulla"),e.k0s()()}}let z=(()=>{var n;class r{constructor(o,t,i,c,f,he,Se,Ee,be){this.activatedRoute=o,this.globalsService=t,this.router=i,this.scriptListService=c,this.scriptManagerService=f,this.toastService=he,this.tokensService=Se,this.scriptSandboxService=Ee,this.changeDetectorRef=be,this.directLinkParam={},this.isForum=!1,this.scriptModel={},this.scriptDefaultModel={},this.isFormValid=!1,this.breadcrumbUrl=u.LP.SCRIPT_SETTINGS,this.breadcrumbNodes=[],this.sandboxes=[],this.targetType=S.CB.USER,this.pendingRequest=!1;const M=this.globalsService.credentials;if(!M)throw new Error("Missing credentials!");this.ffuid=M.user.ffuid}ngOnInit(){var o=this;return(0,p.A)(function*(){o.forum=o.globalsService.forum;const t=o.activatedRoute.snapshot.paramMap.get("scriptId");o.targetType=o.activatedRoute.parent?.snapshot.data.type||S.CB.USER,o.isForum=o.targetType===S.CB.FORUM,t?(o.breadcrumbNodes=[o.isForum?u.LP.SCRIPT_FORUM:u.LP.SCRIPT_USER],o.forumSubscription=o.globalsService.forumObservable.subscribe(i=>{o.forum=i,o.isForum&&(o.script=void 0,o.sandboxes=[],o.setData(t))}),yield o.setData(t)):yield o.redirect()})()}setData(o){var t=this;return(0,p.A)(function*(){if(t.targetType===S.CB.FORUM&&!t.forum)return void(yield t.redirect());const i=yield t.scriptListService.getSingleScriptData(o,t.isForum?t.forum.cid:t.ffuid,t.targetType);if(!i)return void(yield t.redirect());const c=i.script?.sandboxes.filter(f=>f.inSettings)||[];if(i.installed&&(i.script.settings.schema||0!==c.length)&&i.permissions.includes(S.Eq.SETTINGS)){if(t.scriptSchema=i.script.settings.schema?JSON.parse(i.script.settings.schema):void 0,t.scriptModel=i.settings?JSON.parse(i.settings):{},t.scriptDefaultModel=JSON.parse(i.script.settings.default),t.scriptSchema&&(0,C.l$)(t.scriptSchema,"title")&&delete t.scriptSchema.title,t.directLinkParam={[u.FQ.SCRIPT]:i.script.id},c.length>0){const f=yield t.tokensService.generateJwe(C.ru.SANDBOX);t.setSandboxes(c,f,i.script)}t.script=i.script,t.changeDetectorRef.detectChanges()}else yield t.redirect()})()}setSandboxes(o,t,i){(0,G.of)(...o).pipe((0,O.n)(c=>this.scriptSandboxService.create(c.value,{token:t,script:{id:i.id,settings:this.scriptModel}}))).subscribe(c=>{this.sandboxes.push(c)})}redirect(){var o=this;return(0,p.A)(function*(){yield o.router.navigate([o.isForum?u.LP.SCRIPT_FORUM:u.LP.SCRIPT_USER])})()}saveSettings(o){var t=this;return(0,p.A)(function*(){if(!t.pendingRequest)return t.pendingRequest=!0,t.scriptListService.settingsOptions.redirectAfterSaving&&t.redirect().then(),(yield t.scriptManagerService.editSettings(t.isForum?t.forum.cid:t.ffuid,t.targetType,t.script.id,JSON.stringify(o)))?(t.toastService.show({content:`Le impostazioni dello script <strong>${t.script.name}</strong> sono state aggiornate correttamente!`}),void(t.pendingRequest=!1)):(t.toastService.advice(d.d.GENERIC),void(t.pendingRequest=!1));t.toastService.advice(d.d.REQUEST_PENDING)})()}onModelChange(o){for(const t of this.sandboxes)t.eventSubject.next({eventType:C.tV.SCRIPT,eventContent:{settings:o,isFormValid:this.isFormValid}})}ngOnDestroy(){this.forumSubscription?.unsubscribe()}static#e=n=()=>(this.\u0275fac=function(t){return new(t||r)(e.rXU(y.nX),e.rXU(m.k),e.rXU(y.Ix),e.rXU(_.j),e.rXU(I.G),e.rXU(V.f),e.rXU(C.m5),e.rXU(B.q),e.rXU(N.gRc))},this.\u0275cmp=e.VBU({type:r,selectors:[["app-script-settings"]],standalone:!1,decls:10,vars:8,consts:[["modal",""],["cancelButton",""],["customForm",""],["pageTitle","Impostazioni script",1,"d-block",3,"url","nodes"],[1,"wrapper"],["app-script-settings-pageinfo","",1,"d-grid","pageinfo-container",3,"modal","script","directLinkParam","forum","isForum"],[1,"flat-container","p-3","form-container","min-w-0"],[3,"message"],[3,"sandbox"],["app-custom-form","",3,"cancelEvent","submitEvent","modelChangeEvent","validityChangeEvent","schema","model","defaultModel","validateSchema","enableModelChangeEvent"],["buttons",""],["id","form-buttons",1,"list-unstyled","d-flex","justify-content-center","flex-wrap","mb-0"],[1,"me-2","order-first"],["type","button",1,"btn","btn-indigo","d-flex","align-items-center",3,"click"],[1,"d-none","d-sm-block","material-icons"],[1,"ms-sm-1"],[1,"me-sm-auto","order-first"],["type","button",1,"btn","btn-primary","d-flex","align-items-center",3,"click"],[1,"mt-2","mt-sm-0","me-2","order-1"],[4,"ngTemplateOutlet"],[1,"mt-2","mt-sm-0","order-1"],["type","button",1,"btn","btn-success","d-flex","align-items-center",3,"click","disabled"],["buttonsId","form-buttons",3,"tipsEvent","cancelEvent","saveEvent","isFormValid"],["id","back-button",1,"d-flex","justify-content-center","mt-3"],["buttonsId","back-button",3,"tipsEvent","cancelEvent","hasForm"],["type","button",1,"btn","btn-danger","d-flex","align-items-center",3,"click"]],template:function(t,i){if(1&t&&(e.nrm(0,"app-breadcrumb",3),e.j41(1,"div",4),e.nrm(2,"div",5),e.j41(3,"div",6),e.nVh(4,me,4,2)(5,ue,1,1,"app-loader",7),e.k0s()(),e.nrm(6,"app-script-settings-infomodal",null,0),e.DNE(8,ge,5,0,"ng-template",null,1,e.C5r)),2&t){const c=e.sdS(7);e.Y8G("url",i.breadcrumbUrl)("nodes",i.breadcrumbNodes),e.R7$(2),e.Y8G("modal",c)("script",i.script)("directLinkParam",i.directLinkParam)("forum",i.forum)("isForum",i.isForum),e.R7$(2),e.vxM(i.script?4:5)}},dependencies:[U.D,h.T3,L.L,T.V,$.x,Q,ie,ae],styles:['.pageinfo-container[_ngcontent-%COMP%]{margin-bottom:1rem;row-gap:1rem}#form-buttons[_ngcontent-%COMP%]:after{content:"";display:block;width:100%;order:0}@media (min-width: 576px){#form-buttons[_ngcontent-%COMP%]:after{content:none}}@media (min-width: 960px){.pageinfo-container[_ngcontent-%COMP%]{margin-bottom:1.5rem;row-gap:1.5rem}}@media (min-width: 1200px){app-breadcrumb[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]{margin-right:75px}}@media (min-width: 1300px){.pageinfo-container[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);column-gap:1.5rem}}']}))}return n(),r})();var fe=a(5990);const Fe=[{path:"",component:z,pathMatch:"full"},{matcher:n=>1===n.length&&(0,x.h)(n[0].path)?{consumed:n,posParams:{scriptId:n[0]}}:null,component:z}];let ve=(()=>{var n;class r{static#e=n=()=>(this.\u0275fac=function(t){return new(t||r)},this.\u0275mod=e.$C({type:r}),this.\u0275inj=l.G2t({imports:[k._,h.MD,F.w,g.YN,j.iZ,b.Q,v.iI.forChild(Fe),fe.c,P.I]}))}return n(),r})()},5613:(R,E,a)=>{a.d(E,{D:()=>x});var k=a(467),h=a(2881),F=a(2998),g=a(2615);let x=(()=>{var b;class v extends F.DL{constructor(p,d,m){super(p,m),this.graphqlService=p,this.globalsService=d,this.requestsService=m,this.searchByNameCache={}}searchUserByName(p,d){var m=this;return(0,k.A)(function*(){d||(d=(0,F.aQ)(m.globalsService.credentials?.site.domain||F.Zv.FORUMFREE));const u=`${d}${p}`;if((0,F.l$)(m.searchByNameCache,u))return m.searchByNameCache[u];const _=yield m.graphqlService.query({query:"\nquery UserSearchByName($name: String!, $cid: String) {\n    userSearchByName(name: $name, cid: $cid) {\n        uid\n        nickname\n        avatar\n    }\n}",variables:{name:p,cid:d}});return m.searchByNameCache[u]=_.data.userSearchByName})()}static#e=b=()=>(this.\u0275fac=function(d){return new(d||v)(g.KVO(F.Pp),g.KVO(h.k),g.KVO(F.km))},this.\u0275prov=g.jDH({token:v,factory:v.\u0275fac,providedIn:"root"}))}return b(),v})()}}]);